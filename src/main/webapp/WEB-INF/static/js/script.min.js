function BuildulatorConfig(a){a===undefined&&(a=[]);this.wysiwygCss=a.wysiwygCss!==undefined?a.wysiwygCss:"/static/css/editor.css";this.projectsUrl=a.projectsUrl!==undefined?a.projectsUrl:"/projects/";this.projectsNewUrl=a.projectsNewUrl!==undefined?a.projectsNewUrl:"/projects/new";this.projectsListAll=a.projectsListAll!==undefined?a.projectsListAll:"false";this.projectsEditUrl=a.projectsEditUrl!==undefined?a.projectsEditUrl:"/projects/?edit";this.materialLibraryUrl=a.materialLibraryUrl!==undefined?a.materialLibraryUrl:"/library/materials/";this.adminUsersUrl=a.adminUsersUrl!==undefined?a.adminUsersUrl:"/admin/users/";this.saveText=a.saveText!==undefined?a.saveText:"Save"}function SustainabilitySummary(a){function w(){$.getJSON(G,function(a){b=a;x()})}function x(){var a=$("<div/>");$("<h4/>",{html:j.replace("[percentage]",b.percentComplete)}).appendTo(a);var d=$("<ul/>").appendTo(a);$("<li/>",{"class":"operationalComplete",html:k.replace("[detailed]",b.elOperationalDetailed).replace("[total]",b.elOperationalTotal)}).appendTo(d);$("<li/>",{"class":"constructionComplete",html:l.replace("[detailed]",b.elConstructionDetailed).replace("[total]",b.elConstructionTotal)}).appendTo(d);$(e+" div.completionSummary").html(a);var f=F(b.perOccupantCarbonChange,0);f=F(c.perOccupantCarbonChange,f);var g={grid:{borderWidth:1},xaxis:{tickFormatter:function(){return""}},yaxis:{min:f,tickFormatter:function(a){return a+" "+s}},legend:{display:!0,labelBoxBorderColor:null,container:e+" div.carbonSummary div.summaryTotalLegend"}};$(e+" div.carbonSummary").html(y(b.carbonOperational,b.carbonConstruction,b.carbonTotal,b.carbonPerOccupant,n,p,q,r,s));var h={data:b.perOccupantCarbonChange,label:b.name};if(c.perOccupantCarbonChange===undefined)$.plot($(e+" div.carbonSummary div.summaryTotalChange"),[h],g);else{var i=[],m=0;$(b.perOccupantCarbonChange).each(function(a,b){i[m]=[m,c.carbonPerOccupant];m++});var o={data:i,label:c.name+" ("+c.carbonPerOccupant+" "+s+")"};$.plot($(e+" div.carbonSummary div.summaryTotalChange"),[h,o],g)}}function y(a,b,c,d,e,f,g,h,i){var j="<h4>";j+=e;j+="</h4><table><tbody>";j+="<tr><td>";j+=m;j+='</td><td class="summaryValue">';j+=E(a);h!==""&&(j+=" "+h);j+="</td></tr><tr><td>";j+=o;j+='</td><td class="summaryValue">';j+=E(b);h!==""&&(j+=" "+h);j+='</td></tr><tr class="sSummaryTotal"><td>';j+=f;j+='</td><td class="summaryValue">';j+=E(c);h!==""&&(j+=" "+h);j+='</td></tr><tr class="sSummaryPerPerson"><td>';j+=g;j+='</td><td class="summaryValue">';j+=E(d);i!==""&&(j+=" "+i);j+="</td></tr></tbody></table>";j+="<h5>"+t+"</h5>";j+='<div class="summaryTotalChange"></div>';j+='<div class="summaryTotalLegend"></div>';return j}function z(a,b){var c='<div class="comparisonContent">';c+='<div class="comparisonProjects"><h4>';c+=v;c+="</h4>";if(a.project.id!==undefined){c+='<ul class="currentProject">';c+="<li><label>"+a.project.name+"</label></li>";c+="</ul>"}if(a.comparable!==undefined){var f="";$(a.comparable).each(function(a,b){f+='<li><div class="comparableInput">';f+='<input type="checkbox" value="c_'+D(a,5)+"_"+b.id+'" />';f+="</div><label>";f+=b.name;f+="</label></li>"});if(f!==""){c+='<ul class="comparableProjects">';c+=f;c+="</ul>"}}if(a.user!==undefined){var g="";$(a.user).each(function(a,b){g+='<li><div class="comparableInput">';g+='<input type="checkbox" value="u_'+D(a,5)+"_"+b.id+'" />';g+="</div><label>";g+=b.name;g+="</label></li>"});if(g!==""){c+='<ul class="userProjects">';c+=g;c+="</ul>"}}c+='</div><div class="comparisonGraphs">';c+="<h2>"+q+" "+n+"</h2>";c+='<div class="comparisonPerOccupantCarbon"></div>';c+="<h2>"+p+" "+n+"</h2>";c+='<div class="comparisonTotalCarbon"></div>';c+="</div></div>";$(b).html(c);$(e+" div.comparableInput input").change(function(){var a=$(this).val(),b=a.substring(a.lastIndexOf("_")+1,a.length);if($(this).is(":checked")){var c=h+b+"/summary.json";$.getJSON(c,function(b){d[a]=b;A()})}else{delete d[a];A()}})}function A(){B("perOccupant","div.comparisonPerOccupantCarbon");B("total","div.comparisonTotalCarbon")}function B(a,c){var e=[],f=[],g=[],h=0,i=0,j=0;g[0]=[0,""];g[1]=[1,b.name];switch(a){case"perOccupant":i=parseFloat(b.carbonPerOccupantOperational);j=parseFloat(b.carbonPerOccupantConstruction);i+j<h&&(h=i+j);e[0]=[1,i];f[0]=[1,j];break;case"total":i=parseFloat(b.carbonOperational)/1e3;j=parseFloat(b.carbonConstruction)/1e3;i+j<h&&(h=i+j);e[0]=[1,i];f[0]=[1,j]}var k=C(d);$(k).each(function(b,c){var i=d[c],j=e.length,k=j+1,l=0,m=0;if(i!==undefined){g[k]=[k,i.name];switch(a){case"perOccupant":l=parseFloat(i.carbonPerOccupantOperational);m=parseFloat(i.carbonPerOccupantConstruction);l+m<h&&(h=l+m);e[j]=[k,l];f[j]=[k,m];break;case"total":l=parseFloat(i.carbonOperational)/1e3;m=parseFloat(i.carbonConstruction)/1e3;l+m<h&&(h=l+m);e[j]=[k,l];f[j]=[k,m]}}});var l=e.length,n=l+1;g[n]=[n,""];e[l]=[n,null];f[l]=[n,null];var p={grid:{borderWidth:1},xaxis:{min:0,ticks:g,tickLength:4},yaxis:{min:h,tickFormatter:function(a){return a+" "+s}},legend:{display:!0,labelBoxBorderColor:null},series:{stack:0,bars:{show:!0,barWidth:.7,align:"center"}}},q=$(c).parent("div").width()-50,r=$(c).parent("div").height()/2-45;$(c).width(q+"px");$(c).height(r+"px");$.plot(c,[{label:m,data:e},{label:o,data:f}],p)}function C(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b.sort()}function D(a,b){var c=""+a;while(c.length<b)c="0"+c;return c}function E(a){return(Math.round(a*10)/10).toFixed(1)}function F(a,b){b===undefined&&(b=0);a!==undefined&&$(a).each(function(a,c){var d=parseFloat(c);d<b&&(b=d)});return b}a===undefined&&(a=[]);var b=[],c=[],d={},e=a.div!==undefined?a.div:"div#sustainabilitySummary",f=a.publicId!==undefined?a.publicId:0,g=a.targetId!==undefined?a.targetId:0,h=a.projectUrl!==undefined?a.projectUrl:"./projects/",i=a.headingText!==undefined?a.headingText:"Sustainability Summary",j=a.percentageCompleteText!==undefined?a.percentageCompleteText:"<span>[percentage]</span> detailed",k=a.operationalCompleteText!==undefined?a.operationalCompleteText:"<span>[detailed] of [total]</span> energy uses detailed.",l=a.constructionCompleteText!==undefined?a.constructionCompleteText:"<span>[detailed] of [total]</span> elements detailed.",m=a.operationalFootprintText!==undefined?a.operationalFootprintText:"Operational",n=a.carbonText!==undefined?a.carbonText:"Carbon (CO<sub>2</sub>)",o=a.billOfMaterialsText!==undefined?a.billOfMaterialsText:"Embodied",p=a.totalCarbonText!==undefined?a.totalCarbonText:"Total",q=a.perPersonCarbonText!==undefined?a.perPersonCarbonText:"Per Person",r=a.carbonUnitsText!==undefined?a.carbonUnitsText:"g",s=a.carbonPerPersonUnitsText!==undefined?a.carbonPerPersonUnitsText:"kg",t=a.perPersonCarbonGraphText!==undefined?a.perPersonCarbonGraphText:"Per Person Carbon History",u=a.compareButtonText!==undefined?a.compareButtonText:"Compare to other projects",v=a.comparisonProjectsText!==undefined?a.comparisonProjectsText:"Select the projects to compare to:";this._update=function(){w()};var G=h+"share/"+f+"/summary.json",H=h+"share/"+f+"/compare.json",I=h+g+"/summary.json",J=$("<div/>",{"class":"sSummaryContent"}).appendTo(e);$("<h3/>",{html:i}).appendTo(J);$("<div/>",{"class":"summaryCompare",html:"<button>"+u+"</button>"}).appendTo(J);$("<div/>",{"class":"completionSummary"}).appendTo(J);$("<div/>",{"class":"carbonSummary"}).appendTo(J);var K=$("<div/>",{"class":"comparison",style:"display: none;"}).appendTo(J);$(e+" div.summaryCompare button").button().colorbox({href:e+" div.comparisonContent",inline:!0,width:"99%",height:"99%",onComplete:function(){A()}});var L=0;$(window).scroll(function(a){L=$(e).offset().top-parseFloat($(e).css("marginTop").replace(/auto/,0));var b=$(this).scrollTop();if(b>=L){if(!$(e+" div.sSummaryContent").hasClass("summaryFixed")){$(e+" div.sSummaryContent").addClass("summaryFixed");$(e+" div.sSummaryContent").css("top","0px")}}else $(e+" div.sSummaryContent").removeClass("summaryFixed")});$.getJSON(H,function(a){z(a,K)});g>0?$.getJSON(I,function(a){c=a;w()}):w()}function BillOfMaterials(a){function A(){$(d+" div.bomHEdit button").button().click(function(){var a=!0,b=$(d+" ul.bomSections");$(b).hasClass("bomNotEditing")&&(a=!1);if(a){$(d+" .bomCancel").trigger("click");$(this).find("span").html(w);$(b).addClass("bomNotEditing");C()}else{$(this).find("span").html(x);$(b).removeClass("bomNotEditing");B()}});f!=="false"&&B()}function B(){$(d+" div.deleteFromBOM a").bind("click.bomEdit",function(){N(this)});$(d+" li.addToBOM a.addToBOM").bind("click.bomEdit",function(){G(this)});$(d+" div.bomEditable").bind("dblclick.bomEdit",function(){H(this)})}function C(){$(d+" div.deleteFromBOM a").unbind("click.bomEdit");$(d+" li.addToBOM a.addToBOM").unbind("click.bomEdit");$(d+" div.bomEditable").unbind("dblclick.bomEdit")}function D(a){$(a).find("div.deleteFromBOM a").click(function(){N(this)});$(d+" li.addToBOM a.addToBOM").click(function(){G(this)});$(a).find("div.bomEditable").dblclick(function(){H(this)})}function E(a){var c=U(a);$(a).find("input.bomHelpText").bind("focus.bomHelpText",function(a){$(this).removeClass("bomHelpText").val("").unbind("focus.bomHelpText")});$(a).find("input.bomSubmit").button().click(function(a){a.preventDefault();$(this).closest("form").submit()});$(a).find("input.bomCancel").button().click(function(b){b.preventDefault();a.html(M(c));$(a).find("a").click(function(){G(this)})});var d=$(a).find("form");d.validate();d.submit(function(f){f.preventDefault();var i=!0;$(this).find("input.required, input.number").each(function(){$(d).validate().element(this)||(i=!1)});if(!i)return!1;var k="",l="",m="",n="",o="";switch(c){case"section":k=$(a).find("div.bomSectionNameInput input").val();break;case"element":k=$(a).find("div.bomElementNameInput input").val();l=$(a).find("div.bomElementQuantityInput input").val();m=$(a).find("div.bomElementUnitsInput input").val();n=$(a).closest("li.bomSection").index()+1;break;case"material":k=$(a).find("div.bomMaterialNameInput input").val();l=$(a).find("div.bomMaterialQuantityInput input").val();n=$(a).closest("li.bomSection").index()+1;o=$(a).closest("li.bomElement").index()+1}var p="type="+g+"&name="+k+"&quantity="+l+"&units="+m+"&sid="+n+"&eid="+o,q=j+h+"/newitem";$.ajax({type:"POST",url:q,async:!1,cache:!1,data:p,success:function(d){b=$.parseJSON(d);var f="";switch(c){case"section":f=b.sections.length-1;$(a).before(O(b.sections[f]));break;case"element":var g=b.sections[n-1];f=g.elements.length-1;$(a).before(P(g.elements[f]));break;case"material":var h=b.sections[n-1].elements[o-1];f=h.materials.length-1;$(a).before(Q(h.materials[f]))}T();D($(a).prev());e!==null&&e.update();$(a).find("input.bomText").val("").first().focus()},error:function(a){alert("Error adding "+c+": "+a)}})})}function F(a){var c=U(a);$(a).find("input.bomHelpText").bind("focus.bomHelpText",function(a){$(this).removeClass("bomHelpText").val("").unbind("focus.bomHelpText")});$(a).find("input.bomSubmit").button().click(function(a){a.preventDefault();$(this).closest("form").submit()});$(a).find("input.bomCancel").button().click(function(b){b.preventDefault();$(a).children("form").remove();$(a).children("div").removeClass("bomHidden");$(a).dblclick(function(){H(this)})});var d=$(a).find("form");d.validate();d.submit(function(f){f.preventDefault();var i=!0;$(this).find("input.required, input.number").each(function(){$(d).validate().element(this)||(i=!1)});if(!i)return!1;var k="",l="",m="",n=$(a).closest("li.bomSection").index()+1,o="",p="";switch(c){case"section":k=$(a).find("div.bomSectionNameInput input").val();break;case"element":k=$(a).find("div.bomElementNameInput input").val();l=$(a).find("div.bomElementQuantityInput input").val();m=$(a).find("div.bomElementUnitsInput input").val();o=$(a).closest("li.bomElement").index()+1;break;case"material":k=$(a).find("div.bomMaterialNameInput input").val();l=$(a).find("div.bomMaterialQuantityInput input").val();o=$(a).closest("li.bomElement").index()+1;p=$(a).closest("li.bomMaterial").index()+1}var q="type="+g+"&name="+k+"&quantity="+l+"&units="+m+"&sid="+n+"&eid="+o+"&mid="+p,r=j+h+"/edititem";$.ajax({type:"POST",url:r,async:!1,cache:!1,data:q,success:function(d){b=$.parseJSON(d);var f=$(a).closest("li");switch(c){case"section":f.before(O(b.sections[n-1]));break;case"element":var g=b.sections[n-1];f.before(P(g.elements[o-1]));break;case"material":var h=b.sections[n-1].elements[o-1];f.before(Q(h.materials[p-1]))}T();D(f.prev());e!==null&&e.update();f.remove()},error:function(a){alert("Error editing "+c+": "+a)}})})}function G(a){var b=$(a).closest("li.addToBOM");$(b).html("<form>"+L(a)+J(k,m)+"</form>");I(b);E(b);$(b).find("input:first").focus()}function H(a){var c=$(a).closest("li.bomSection").index(),d=[],e,f;switch(U(a)){case"material":e=$(a).closest("li.bomElement").index();f=$(a).closest("li.bomMaterial").index();d=b.sections[c].elements[e].materials[f];break;case"element":e=$(a).closest("li.bomElement").index();d=b.sections[c].elements[e];break;default:d=b.sections[c]}$(a).children("div").addClass("bomHidden");$(a).append("<form>"+L(a,d)+J(l,m)+"</form>");I(a);F(a);$(a).off("dblclick");$(a).find("input:first").focus()}function I(a){if(U(a)==="material"){var b=$(a).find("input.bomSelectValue").val(),d="";$(a).find("select.bomSelect").each(function(){var e=[];$(c).each(function(a,c){var f="";b===""&&(b=c.name);if(b===c.name){f="selected";d=c.units}e[a]='<option value="'+c.name+'" '+f+">"+c.name+"</option>"});$(this).html(e.join(""));$(this).selectmenu({width:"351px"}).change(function(){var b=$(this).val();$(c).each(function(c,d){if(d.name===b){$(a).find("input.bomSelectValue").val(d.name);$(a).find("div.bomMUnits").html(d.units)}})})});$(a).find("input.bomSelectValue").val(b);$(a).find("div.bomMUnits").html(d)}}function J(a,b){var c='<div class="bomAddSubmitCancelOptions"><input type="submit" class="bomSubmit" value="'+a+'" />';return c+'<input type="button" class="bomCancel" value="'+b+'" /></div>'}function K(a){return'<li class="addToBOM">'+M(a)+"</li>"}function L(a,b){var c="";if(b===undefined){b=[];if(y!==""){b.quantity=y;c="bomHelpText"}if(z!==""){b.units=z;c="bomHelpText"}}var d=b.name!==undefined?b.name:"",e=b.units!==undefined?b.units:"",f=b.quantity!==undefined?b.quantity:"";b.mname!==undefined&&(d=b.mname);var g="",h,i;switch(U(a)){case"element":h=$(a).closest("li.bomSection").index();g+='<div class="bomElementNameInput"><input type="text" class="bomText required" id="bomS'+h+'ElementName" value="'+d+'" /></div>';g+='<div class="bomElementQuantityInput"><input type="text" class="bomText required number '+c+'" id="bomS'+h+'ElementQuantity" value="'+f+'" /></div>';g+='<div class="bomElementUnitsInput"><input type="text" class="bomText '+c+'" id="bomS'+h+'ElementUnits" value="'+e+'" /></div>';break;case"material":h=$(a).closest("li.bomSection").index();i=$(a).closest("li.bomElement").index();g='<div class="bomMaterialNameInput"><input type="text" class="bomSelectValue" id="bomS'+h+"E"+i+'MaterialName" value="'+d+'" />';g+='<select type="text" class="bomSelect" id="bomS'+h+"E"+i+'MaterialSelect" value="'+d+'" /></div>';g+='<div class="bomMaterialQuantityInput"><input type="text" class="bomText required number '+c+'" id="bomS'+h+"E"+i+'MaterialQuantity" value="'+f+'" />';g+='</div><div class="bomMUnits"></div>';break;default:g+='<div class="bomSectionNameInput"><input type="text" class="bomText required" id="bomSectionName" value="'+d+'" /></div>'}return g}function M(a){return'<a class="addToBOM">'+k+" "+V(a)+"</a>"}function N(a){var c=U(a);if(confirm(r+" "+V(c)+"?")){var d=$(a).closest("li.bomSection").index()+1,f="",i="";switch(c){case"material":f=$(a).closest("li.bomElement").index()+1;i=$(a).closest("li.bomMaterial").index()+1;break;case"element":f=$(a).closest("li.bomElement").index()+1}var k="type="+g+"&sid="+d+"&eid="+f+"&mid="+i,l=j+h+"/deleteitem";$.ajax({type:"POST",url:l,async:!1,cache:!1,data:k,success:function(c){b=$.parseJSON(c);$(a).closest("li").remove();T();e!==null&&e.update()},error:function(a){alert("Error deleting "+c+": "+a)}})}}function O(a){var b='<li class="bomSection"><div class="bomEditable"><div class="deleteFromBOM"><a>';b+=q+'</a></div><div class="bomSName">';b+=W(a.name);b+='</div><div class="bomSCarbon">';b+='</div></div><ul class="bomElements">';var c=[];$(a.elements).each(function(a,b){c[a]=P(b)});b+=c.join("");b+=K("element")+'</ul><div class="bomSectionDivider"></div></li>';return b}function P(a){var b='<li class="bomElement"><div class="bomEditable"><div class="deleteFromBOM"><a>';b+=q+'</a></div><div class="bomEName">';b+=W(a.name);b+='</div><div class="bomEQuantity">';b+=W(a.quantity);b+='</div><div class="bomEUnits">';b+=W(a.units);b+='</div><div class="bomECarbon">';b+='</div></div><ul class="bomMaterials">';var c=[];$(a.materials).each(function(a,b){c[a]=Q(b)});b+=c.join("");b+=K("material")+"</ul></li>";return b}function Q(a){var b='<li class="bomMaterial"><div class="bomEditable"><div class="deleteFromBOM"><a>';b+=q+'</a></div><div class="bomMName">';b+=W(a.mname);b+='</div><div class="bomMQuantity">';b+=W(a.quantity);b+='</div><div class="bomMUnits">';b+=W(a.units);b+='</div><div class="bomMCarbon">';b+=W(a.totalCarbon);b+="</div></div></li>";return b}function R(){var a='<div class="bomHEdit">';if(h>0){a+="<button>";f==="false"?a+=w:a+=x;a+="</button>"}a+='</div><div class="bomHName">';a+=s;a+='</div><div class="bomHQuantity">';a+=t;a+='</div><div class="bomHCarbon">';a+=u;a+='</div><div class="bomHClear"></div>';return a}function S(){var a='<div class="bomFSummary">';a+=v;a+='</div><div class="bomFCarbon">';a+=b.totalCarbon;a+='</div><div class="bomFClear"></div>';return a}function T(){$(d+" div.bomFCarbon").html(b.totalCarbon)}function U(a){var b=$(a).closest("ul").attr("class"),c="section";switch(b){case"bomElements":c="element";break;case"bomMaterials":c="material"}return c}function V(a){var b=p;switch(a){case"section":b=n;break;case"element":b=o}return b}function W(a){var b="";a!==undefined&&a!==""&&(b=a);return b}a===undefined&&(a=[]);var b=[],c=[],d=a.div!==undefined?a.div:"div.bomTable",e=a.summary!==undefined?a.summary:null,f=a.editing!==undefined?a.editing:"false",g=a.type!==undefined?a.type:"construction",h=a.projectId!==undefined?a.projectId:0,i=a.publicId!==undefined?a.publicId:0,j=a.projectUrl!==undefined?a.projectUrl:"./projects/",k=a.addText!==undefined?a.addText:"Add",l=a.editText!==undefined?a.editText:"OK",m=a.cancelText!==undefined?a.cancelText:"Cancel",n=a.sectionText!==undefined?a.sectionText:"section",o=a.elementText!==undefined?a.elementText:"element",p=a.materialText!==undefined?a.materialText:"material",q=a.deleteText!==undefined?a.deleteText:"Delete",r=a.deleteConfirmText!==undefined?a.deleteConfirmText:"Are you sure you want to delete this",s=a.headerNameText!==undefined?a.headerNameText:"",t=a.headerQuantityText!==undefined?a.headerQuantityText:"Quantity",u=a.headerCarbonText!==undefined?a.headerCarbonText:"Carbon (g CO<sub>2</sub>)",v=a.footerSummaryText!==undefined?a.footerSummaryText:"Total embodied carbon (g)",w=a.editStartText!==undefined?a.editStartText:"Edit table",x=a.editFinishText!==undefined?a.editFinishText:"Finish editing",y=a.quantityText!==undefined?a.quantityText:"Quantity",z=a.unitsText!==undefined?a.unitsText:"Units",X=j+"share/"+i+"/bom.json?type="+g.toLowerCase(),Y=j+"/materials.json?type="+g.toLowerCase();$.getJSON(Y,function(a){c=a});$.getJSON(X,function(a){b=a;var c=[];$(b.sections).each(function(a,b){c[a]=O(b)});$("<div/>",{"class":"bomHeader",html:R()}).appendTo(d);var e="bomSections";f==="false"&&(e+=" bomNotEditing");$("<ul/>",{"class":e,html:c.join("")+K("section")}).appendTo(d);$("<div/>",{"class":"bomFooter",html:S()}).appendTo(d);A()})}(function(a){a.color={};a.color.make=function(b,c,d,e){var f={};f.r=b||0;f.g=c||0;f.b=d||0;f.a=e!=null?e:1;f.add=function(a,b){for(var c=0;c<a.length;++c)f[a.charAt(c)]+=b;return f.normalize()};f.scale=function(a,b){for(var c=0;c<a.length;++c)f[a.charAt(c)]*=b;return f.normalize()};f.toString=function(){return f.a>=1?"rgb("+[f.r,f.g,f.b].join(",")+")":"rgba("+[f.r,f.g,f.b,f.a].join(",")+")"};f.normalize=function(){function a(a,b,c){return b<a?a:b>c?c:b}f.r=a(0,parseInt(f.r),255);f.g=a(0,parseInt(f.g),255);f.b=a(0,parseInt(f.b),255);f.a=a(0,f.a,1);return f};f.clone=function(){return a.color.make(f.r,f.b,f.g,f.a)};return f.normalize()};a.color.extract=function(b,c){var d;do{d=b.css(c).toLowerCase();if(d!=""&&d!="transparent")break;b=b.parent()}while(!a.nodeName(b.get(0),"body"));d=="rgba(0, 0, 0, 0)"&&(d="transparent");return a.color.parse(d)};a.color.parse=function(c){var d,e=a.color.make;if(d=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(c))return e(parseInt(d[1],10),parseInt(d[2],10),parseInt(d[3],10));if(d=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(c))return e(parseInt(d[1],10),parseInt(d[2],10),parseInt(d[3],10),parseFloat(d[4]));if(d=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(c))return e(parseFloat(d[1])*2.55,parseFloat(d[2])*2.55,parseFloat(d[3])*2.55);if(d=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(c))return e(parseFloat(d[1])*2.55,parseFloat(d[2])*2.55,parseFloat(d[3])*2.55,parseFloat(d[4]));if(d=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(c))return e(parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16));if(d=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(c))return e(parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16),parseInt(d[3]+d[3],16));var f=a.trim(c).toLowerCase();if(f=="transparent")return e(255,255,255,0);d=b[f]||[0,0,0];return e(d[0],d[1],d[2])};var b={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);(function(a){function b(b,d,e,f){function x(a,b){b=[w].concat(b);for(var c=0;c<a.length;++c)a[c].apply(this,b)}function y(){for(var b=0;b<f.length;++b){var c=f[b];c.init(w);c.options&&a.extend(!0,h,c.options)}}function z(b){var c;a.extend(!0,h,b);h.xaxis.color==null&&(h.xaxis.color=h.grid.color);h.yaxis.color==null&&(h.yaxis.color=h.grid.color);h.xaxis.tickColor==null&&(h.xaxis.tickColor=h.grid.tickColor);h.yaxis.tickColor==null&&(h.yaxis.tickColor=h.grid.tickColor);h.grid.borderColor==null&&(h.grid.borderColor=h.grid.color);h.grid.tickColor==null&&(h.grid.tickColor=a.color.parse(h.grid.color).scale("a",.22).toString());for(c=0;c<Math.max(1,h.xaxes.length);++c)h.xaxes[c]=a.extend(!0,{},h.xaxis,h.xaxes[c]);for(c=0;c<Math.max(1,h.yaxes.length);++c)h.yaxes[c]=a.extend(!0,{},h.yaxis,h.yaxes[c]);h.xaxis.noTicks&&h.xaxis.ticks==null&&(h.xaxis.ticks=h.xaxis.noTicks);h.yaxis.noTicks&&h.yaxis.ticks==null&&(h.yaxis.ticks=h.yaxis.noTicks);if(h.x2axis){h.xaxes[1]=a.extend(!0,{},h.xaxis,h.x2axis);h.xaxes[1].position="top"}if(h.y2axis){h.yaxes[1]=a.extend(!0,{},h.yaxis,h.y2axis);h.yaxes[1].position="right"}h.grid.coloredAreas&&(h.grid.markings=h.grid.coloredAreas);h.grid.coloredAreasColor&&(h.grid.markingsColor=h.grid.coloredAreasColor);h.lines&&a.extend(!0,h.series.lines,h.lines);h.points&&a.extend(!0,h.series.points,h.points);h.bars&&a.extend(!0,h.series.bars,h.bars);h.shadowSize!=null&&(h.series.shadowSize=h.shadowSize);for(c=0;c<h.xaxes.length;++c)G(o,c+1).options=h.xaxes[c];for(c=0;c<h.yaxes.length;++c)G(p,c+1).options=h.yaxes[c];for(var d in v)h.hooks[d]&&h.hooks[d].length&&(v[d]=v[d].concat(h.hooks[d]));x(v.processOptions,[h])}function A(a){g=B(a);H();I()}function B(b){var c=[];for(var d=0;d<b.length;++d){var e=a.extend(!0,{},h.series);if(b[d].data!=null){e.data=b[d].data;delete b[d].data;a.extend(!0,e,b[d]);b[d].data=e.data}else e.data=b[d];c.push(e)}return c}function C(a,b){var c=a[b+"axis"];typeof c=="object"&&(c=c.n);typeof c!="number"&&(c=1);return c}function D(){return a.grep(o.concat(p),function(a){return a})}function E(a){var b={},c,d;for(c=0;c<o.length;++c){d=o[c];d&&d.used&&(b["x"+d.n]=d.c2p(a.left))}for(c=0;c<p.length;++c){d=p[c];d&&d.used&&(b["y"+d.n]=d.c2p(a.top))}b.x1!==undefined&&(b.x=b.x1);b.y1!==undefined&&(b.y=b.y1);return b}function F(a){var b={},c,d,e;for(c=0;c<o.length;++c){d=o[c];if(d&&d.used){e="x"+d.n;a[e]==null&&d.n==1&&(e="x");if(a[e]!=null){b.left=d.p2c(a[e]);break}}}for(c=0;c<p.length;++c){d=p[c];if(d&&d.used){e="y"+d.n;a[e]==null&&d.n==1&&(e="y");if(a[e]!=null){b.top=d.p2c(a[e]);break}}}return b}function G(b,c){b[c-1]||(b[c-1]={n:c,direction:b==o?"x":"y",options:a.extend(!0,{},b==o?h.xaxis:h.yaxis)});return b[c-1]}function H(){var b,c=g.length,d=[],e=[];for(b=0;b<g.length;++b){var f=g[b].color;if(f!=null){--c;typeof f=="number"?e.push(f):d.push(a.color.parse(g[b].color))}}for(b=0;b<e.length;++b)c=Math.max(c,e[b]+1);var i=[],j=0;b=0;while(i.length<c){var k;h.colors.length==b?k=a.color.make(100,100,100):k=a.color.parse(h.colors[b]);var l=j%2==1?-1:1;k.scale("rgb",1+l*Math.ceil(j/2)*.2);i.push(k);++b;if(b>=h.colors.length){b=0;++j}}var m=0,n;for(b=0;b<g.length;++b){n=g[b];if(n.color==null){n.color=i[m].toString();++m}else typeof n.color=="number"&&(n.color=i[n.color].toString());if(n.lines.show==null){var q,r=!0;for(q in n)if(n[q]&&n[q].show){r=!1;break}r&&(n.lines.show=!0)}n.xaxis=G(o,C(n,"x"));n.yaxis=G(p,C(n,"y"))}}function I(){function t(a,b,c){b<a.datamin&&b!=-d&&(a.datamin=b);c>a.datamax&&c!=d&&(a.datamax=c)}var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=Number.MAX_VALUE,e,f,h,i,j,k,l,m,n,o,p,q,r,s;a.each(D(),function(a,d){d.datamin=b;d.datamax=c;d.used=!1});for(e=0;e<g.length;++e){k=g[e];k.datapoints={points:[]};x(v.processRawData,[k,k.data,k.datapoints])}for(e=0;e<g.length;++e){k=g[e];var u=k.data,w=k.datapoints.format;if(!w){w=[];w.push({x:!0,number:!0,required:!0});w.push({y:!0,number:!0,required:!0});if(k.bars.show||k.lines.show&&k.lines.fill){w.push({y:!0,number:!0,required:!1,defaultValue:0});if(k.bars.horizontal){delete w[w.length-1].y;w[w.length-1].x=!0}}k.datapoints.format=w}if(k.datapoints.pointsize!=null)continue;k.datapoints.pointsize=w.length;m=k.datapoints.pointsize;l=k.datapoints.points;insertSteps=k.lines.show&&k.lines.steps;k.xaxis.used=k.yaxis.used=!0;for(f=h=0;f<u.length;++f,h+=m){s=u[f];var y=s==null;if(!y)for(i=0;i<m;++i){q=s[i];r=w[i];if(r){if(r.number&&q!=null){q=+q;isNaN(q)?q=null:q==Infinity?q=d:q==-Infinity&&(q=-d)}if(q==null){r.required&&(y=!0);r.defaultValue!=null&&(q=r.defaultValue)}}l[h+i]=q}if(y)for(i=0;i<m;++i){q=l[h+i];if(q!=null){r=w[i];r.x&&t(k.xaxis,q,q);r.y&&t(k.yaxis,q,q)}l[h+i]=null}else if(insertSteps&&h>0&&l[h-m]!=null&&l[h-m]!=l[h]&&l[h-m+1]!=l[h+1]){for(i=0;i<m;++i)l[h+m+i]=l[h+i];l[h+1]=l[h-m+1];h+=m}}}for(e=0;e<g.length;++e){k=g[e];x(v.processDatapoints,[k,k.datapoints])}for(e=0;e<g.length;++e){k=g[e];l=k.datapoints.points,m=k.datapoints.pointsize;var z=b,A=b,B=c,C=c;for(f=0;f<l.length;f+=m){if(l[f]==null)continue;for(i=0;i<m;++i){q=l[f+i];r=w[i];if(!r||q==d||q==-d)continue;if(r.x){q<z&&(z=q);q>B&&(B=q)}if(r.y){q<A&&(A=q);q>C&&(C=q)}}}if(k.bars.show){var E=k.bars.align=="left"?0:-k.bars.barWidth/2;if(k.bars.horizontal){A+=E;C+=E+k.bars.barWidth}else{z+=E;B+=E+k.bars.barWidth}}t(k.xaxis,z,B);t(k.yaxis,A,C)}a.each(D(),function(a,d){d.datamin==b&&(d.datamin=null);d.datamax==c&&(d.datamax=null)})}function J(c,d){var e=document.createElement("canvas");e.className=d;e.width=r;e.height=s;c||a(e).css({position:"absolute",left:0,top:0});a(e).appendTo(b);e.getContext||(e=window.G_vmlCanvasManager.initElement(e));e.getContext("2d").save();return e}function K(){r=b.width();s=b.height();if(r<=0||s<=0)throw"Invalid dimensions for plot, width = "+r+", height = "+s}function L(a){a.width!=r&&(a.width=r);a.height!=s&&(a.height=s);var b=a.getContext("2d");b.restore();b.save()}function M(){var c,d=b.children("canvas.base"),e=b.children("canvas.overlay");if(d.length==0||e==0){b.html("");b.css({padding:0});b.css("position")=="static"&&b.css("position","relative");K();j=J(!0,"base");k=J(!1,"overlay");c=!1}else{j=d.get(0);k=e.get(0);c=!0}m=j.getContext("2d");n=k.getContext("2d");l=a([k,j]);if(c){b.data("plot").shutdown();w.resize();n.clearRect(0,0,r,s);l.unbind();b.children().not([j,k]).remove()}b.data("plot",w)}function N(){if(h.grid.hoverable){l.mousemove(mb);l.mouseleave(nb)}h.grid.clickable&&l.click(ob);x(v.bindEvents,[l])}function O(){kb&&clearTimeout(kb);l.unbind("mousemove",mb);l.unbind("mouseleave",nb);l.unbind("click",ob);x(v.shutdown,[l])}function P(a){function b(a){return a}var c,d,e=a.options.transform||b,f=a.options.inverseTransform;if(a.direction=="x"){c=a.scale=t/Math.abs(e(a.max)-e(a.min));d=Math.min(e(a.max),e(a.min))}else{c=a.scale=u/Math.abs(e(a.max)-e(a.min));c=-c;d=Math.max(e(a.max),e(a.min))}e==b?a.p2c=function(a){return(a-d)*c}:a.p2c=function(a){return(e(a)-d)*c};f?a.c2p=function(a){return f(d+a/c)}:a.c2p=function(a){return d+a/c}}function Q(c){function l(d,e){return a('<div style="position:absolute;top:-10000px;'+e+'font-size:smaller">'+'<div class="'+c.direction+"Axis "+c.direction+c.n+'Axis">'+d.join("")+"</div></div>").appendTo(b)}var d=c.options,e,f=c.ticks||[],g=[],h,i=d.labelWidth,j=d.labelHeight,k;if(c.direction=="x"){i==null&&(i=Math.floor(r/(f.length>0?f.length:1)));if(j==null){g=[];for(e=0;e<f.length;++e){h=f[e].label;h&&g.push('<div class="tickLabel" style="float:left;width:'+i+'px">'+h+"</div>")}if(g.length>0){g.push('<div style="clear:left"></div>');k=l(g,"width:10000px;");j=k.height();k.remove()}}}else if(i==null||j==null){for(e=0;e<f.length;++e){h=f[e].label;h&&g.push('<div class="tickLabel">'+h+"</div>")}if(g.length>0){k=l(g,"");i==null&&(i=k.children().width());j==null&&(j=k.find("div.tickLabel").height());k.remove()}}i==null&&(i=0);j==null&&(j=0);c.labelWidth=i;c.labelHeight=j}function R(b){var c=b.labelWidth,d=b.labelHeight,e=b.options.position,f=b.options.tickLength,g=h.grid.axisMargin,i=h.grid.labelMargin,j=b.direction=="x"?o:p,k,l=a.grep(j,function(a){return a&&a.options.position==e&&a.reserveSpace});a.inArray(b,l)==l.length-1&&(g=0);f==null&&(f="full");var m=a.grep(j,function(a){return a&&a.reserveSpace}),n=a.inArray(b,m)==0;!n&&f=="full"&&(f=5);isNaN(+f)||(i+=+f);if(b.direction=="x"){d+=i;if(e=="bottom"){q.bottom+=d+g;b.box={top:s-q.bottom,height:d}}else{b.box={top:q.top+g,height:d};q.top+=d+g}}else{c+=i;if(e=="left"){b.box={left:q.left+g,width:c};q.left+=c+g}else{q.right+=c+g;b.box={left:r-q.right,width:c}}}b.position=e;b.tickLength=f;b.box.padding=i;b.innermost=n}function S(a){if(a.direction=="x"){a.box.left=q.left;a.box.width=t}else{a.box.top=q.top;a.box.height=u}}function T(){var b,c=D();a.each(c,function(a,b){b.show=b.options.show;b.show==null&&(b.show=b.used);b.reserveSpace=b.show||b.options.reserveSpace;U(b)});allocatedAxes=a.grep(c,function(a){return a.reserveSpace});q.left=q.right=q.top=q.bottom=0;if(h.grid.show){a.each(allocatedAxes,function(a,b){V(b);W(b);X(b,b.ticks);Q(b)});for(b=allocatedAxes.length-1;b>=0;--b)R(allocatedAxes[b]);var d=h.grid.minBorderMargin;if(d==null){d=0;for(b=0;b<g.length;++b)d=Math.max(d,g[b].points.radius+g[b].points.lineWidth/2)}for(var e in q){q[e]+=h.grid.borderWidth;q[e]=Math.max(d,q[e])}}t=r-q.left-q.right;u=s-q.bottom-q.top;a.each(c,function(a,b){P(b)});if(h.grid.show){a.each(allocatedAxes,function(a,b){S(b)});bb()}ib()}function U(a){var b=a.options,c=+(b.min!=null?b.min:a.datamin),d=+(b.max!=null?b.max:a.datamax),e=d-c;if(e==0){var f=d==0?1:.01;b.min==null&&(c-=f);if(b.max==null||b.min!=null)d+=f}else{var g=b.autoscaleMargin;if(g!=null){if(b.min==null){c-=e*g;c<0&&a.datamin!=null&&a.datamin>=0&&(c=0)}if(b.max==null){d+=e*g;d>0&&a.datamax!=null&&a.datamax<=0&&(d=0)}}}a.min=c;a.max=d}function V(b){var d=b.options,e;typeof d.ticks=="number"&&d.ticks>0?e=d.ticks:e=.3*Math.sqrt(b.direction=="x"?r:s);var f=(b.max-b.min)/e,g,h,i,j,k,l,m;if(d.mode=="time"){var n={second:1e3,minute:6e4,hour:36e5,day:864e5,month:2592e6,year:525949.2*60*1e3},q=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"
],[.5,"month"],[1,"month"],[2,"month"],[3,"month"],[6,"month"],[1,"year"]],t=0;d.minTickSize!=null&&(typeof d.tickSize=="number"?t=d.tickSize:t=d.minTickSize[0]*n[d.minTickSize[1]]);for(var k=0;k<q.length-1;++k)if(f<(q[k][0]*n[q[k][1]]+q[k+1][0]*n[q[k+1][1]])/2&&q[k][0]*n[q[k][1]]>=t)break;g=q[k][0];i=q[k][1];if(i=="year"){l=Math.pow(10,Math.floor(Math.log(f/n.year)/Math.LN10));m=f/n.year/l;m<1.5?g=1:m<3?g=2:m<7.5?g=5:g=10;g*=l}b.tickSize=d.tickSize||[g,i];h=function(a){var b=[],d=a.tickSize[0],e=a.tickSize[1],f=new Date(a.min),g=d*n[e];e=="second"&&f.setUTCSeconds(c(f.getUTCSeconds(),d));e=="minute"&&f.setUTCMinutes(c(f.getUTCMinutes(),d));e=="hour"&&f.setUTCHours(c(f.getUTCHours(),d));e=="month"&&f.setUTCMonth(c(f.getUTCMonth(),d));e=="year"&&f.setUTCFullYear(c(f.getUTCFullYear(),d));f.setUTCMilliseconds(0);g>=n.minute&&f.setUTCSeconds(0);g>=n.hour&&f.setUTCMinutes(0);g>=n.day&&f.setUTCHours(0);g>=n.day*4&&f.setUTCDate(1);g>=n.year&&f.setUTCMonth(0);var h=0,i=Number.NaN,j;do{j=i;i=f.getTime();b.push(i);if(e=="month")if(d<1){f.setUTCDate(1);var k=f.getTime();f.setUTCMonth(f.getUTCMonth()+1);var l=f.getTime();f.setTime(i+h*n.hour+(l-k)*d);h=f.getUTCHours();f.setUTCHours(0)}else f.setUTCMonth(f.getUTCMonth()+d);else e=="year"?f.setUTCFullYear(f.getUTCFullYear()+d):f.setTime(i+g)}while(i<a.max&&i!=j);return b};j=function(b,c){var e=new Date(b);if(d.timeformat!=null)return a.plot.formatDate(e,d.timeformat,d.monthNames);var f=c.tickSize[0]*n[c.tickSize[1]],g=c.max-c.min,h=d.twelveHourClock?" %p":"";f<n.minute?fmt="%h:%M:%S"+h:f<n.day?g<2*n.day?fmt="%h:%M"+h:fmt="%b %d %h:%M"+h:f<n.month?fmt="%b %d":f<n.year?g<n.year?fmt="%b":fmt="%b %y":fmt="%y";return a.plot.formatDate(e,fmt,d.monthNames)}}else{var u=d.tickDecimals,v=-Math.floor(Math.log(f)/Math.LN10);u!=null&&v>u&&(v=u);l=Math.pow(10,-v);m=f/l;if(m<1.5)g=1;else if(m<3){g=2;if(m>2.25&&(u==null||v+1<=u)){g=2.5;++v}}else m<7.5?g=5:g=10;g*=l;d.minTickSize!=null&&g<d.minTickSize&&(g=d.minTickSize);b.tickDecimals=Math.max(0,u!=null?u:v);b.tickSize=d.tickSize||g;h=function(a){var b=[],d=c(a.min,a.tickSize),e=0,f=Number.NaN,g;do{g=f;f=d+e*a.tickSize;b.push(f);++e}while(f<a.max&&f!=g);return b};j=function(a,b){return a.toFixed(b.tickDecimals)}}if(d.alignTicksWithAxis!=null){var w=(b.direction=="x"?o:p)[d.alignTicksWithAxis-1];if(w&&w.used&&w!=b){var x=h(b);if(x.length>0){d.min==null&&(b.min=Math.min(b.min,x[0]));d.max==null&&x.length>1&&(b.max=Math.max(b.max,x[x.length-1]))}h=function(a){var b=[],c,d;for(d=0;d<w.ticks.length;++d){c=(w.ticks[d].v-w.min)/(w.max-w.min);c=a.min+c*(a.max-a.min);b.push(c)}return b};if(b.mode!="time"&&d.tickDecimals==null){var y=Math.max(0,-Math.floor(Math.log(f)/Math.LN10)+1),z=h(b);z.length>1&&/\..*0$/.test((z[1]-z[0]).toFixed(y))||(b.tickDecimals=y)}}}b.tickGenerator=h;a.isFunction(d.tickFormatter)?b.tickFormatter=function(a,b){return""+d.tickFormatter(a,b)}:b.tickFormatter=j}function W(b){var c=b.options.ticks,d=[];c==null||typeof c=="number"&&c>0?d=b.tickGenerator(b):c&&(a.isFunction(c)?d=c({min:b.min,max:b.max}):d=c);var e,f;b.ticks=[];for(e=0;e<d.length;++e){var g=null,h=d[e];if(typeof h=="object"){f=+h[0];h.length>1&&(g=h[1])}else f=+h;g==null&&(g=b.tickFormatter(f,b));isNaN(f)||b.ticks.push({v:f,label:g})}}function X(a,b){if(a.options.autoscaleMargin&&b.length>0){a.options.min==null&&(a.min=Math.min(a.min,b[0].v));a.options.max==null&&b.length>1&&(a.max=Math.max(a.max,b[b.length-1].v))}}function Y(){m.clearRect(0,0,r,s);var a=h.grid;a.show&&a.backgroundColor&&_();a.show&&!a.aboveData&&ab();for(var b=0;b<g.length;++b){x(v.drawSeries,[m,g[b]]);cb(g[b])}x(v.draw,[m]);a.show&&a.aboveData&&ab()}function Z(a,b){var c,d,e,f,g=D();for(i=0;i<g.length;++i){c=g[i];if(c.direction==b){f=b+c.n+"axis";!a[f]&&c.n==1&&(f=b+"axis");if(a[f]){d=a[f].from;e=a[f].to;break}}}if(!a[f]){c=b=="x"?o[0]:p[0];d=a[b+"1"];e=a[b+"2"]}if(d!=null&&e!=null&&d>e){var h=d;d=e;e=h}return{from:d,to:e,axis:c}}function _(){m.save();m.translate(q.left,q.top);m.fillStyle=xb(h.grid.backgroundColor,u,0,"rgba(255, 255, 255, 0)");m.fillRect(0,0,t,u);m.restore()}function ab(){var b;m.save();m.translate(q.left,q.top);var c=h.grid.markings;if(c){if(a.isFunction(c)){var d=w.getAxes();d.xmin=d.xaxis.min;d.xmax=d.xaxis.max;d.ymin=d.yaxis.min;d.ymax=d.yaxis.max;c=c(d)}for(b=0;b<c.length;++b){var e=c[b],f=Z(e,"x"),g=Z(e,"y");f.from==null&&(f.from=f.axis.min);f.to==null&&(f.to=f.axis.max);g.from==null&&(g.from=g.axis.min);g.to==null&&(g.to=g.axis.max);if(f.to<f.axis.min||f.from>f.axis.max||g.to<g.axis.min||g.from>g.axis.max)continue;f.from=Math.max(f.from,f.axis.min);f.to=Math.min(f.to,f.axis.max);g.from=Math.max(g.from,g.axis.min);g.to=Math.min(g.to,g.axis.max);if(f.from==f.to&&g.from==g.to)continue;f.from=f.axis.p2c(f.from);f.to=f.axis.p2c(f.to);g.from=g.axis.p2c(g.from);g.to=g.axis.p2c(g.to);if(f.from==f.to||g.from==g.to){m.beginPath();m.strokeStyle=e.color||h.grid.markingsColor;m.lineWidth=e.lineWidth||h.grid.markingsLineWidth;m.moveTo(f.from,g.from);m.lineTo(f.to,g.to);m.stroke()}else{m.fillStyle=e.color||h.grid.markingsColor;m.fillRect(f.from,g.to,f.to-f.from,g.from-g.to)}}}var d=D(),i=h.grid.borderWidth;for(var j=0;j<d.length;++j){var k=d[j],l=k.box,n=k.tickLength,o,p,r,s;if(!k.show||k.ticks.length==0)continue;m.strokeStyle=k.options.tickColor||a.color.parse(k.options.color).scale("a",.22).toString();m.lineWidth=1;if(k.direction=="x"){o=0;n=="full"?p=k.position=="top"?0:u:p=l.top-q.top+(k.position=="top"?l.height:0)}else{p=0;n=="full"?o=k.position=="left"?0:t:o=l.left-q.left+(k.position=="left"?l.width:0)}if(!k.innermost){m.beginPath();r=s=0;k.direction=="x"?r=t:s=u;if(m.lineWidth==1){o=Math.floor(o)+.5;p=Math.floor(p)+.5}m.moveTo(o,p);m.lineTo(o+r,p+s);m.stroke()}m.beginPath();for(b=0;b<k.ticks.length;++b){var v=k.ticks[b].v;r=s=0;if(v<k.min||v>k.max||n=="full"&&i>0&&(v==k.min||v==k.max))continue;if(k.direction=="x"){o=k.p2c(v);s=n=="full"?-u:n;k.position=="top"&&(s=-s)}else{p=k.p2c(v);r=n=="full"?-t:n;k.position=="left"&&(r=-r)}m.lineWidth==1&&(k.direction=="x"?o=Math.floor(o)+.5:p=Math.floor(p)+.5);m.moveTo(o,p);m.lineTo(o+r,p+s)}m.stroke()}if(i){m.lineWidth=i;m.strokeStyle=h.grid.borderColor;m.strokeRect(-i/2,-i/2,t+i,u+i)}m.restore()}function bb(){b.find(".tickLabels").remove();var a=['<div class="tickLabels" style="font-size:smaller">'],c=D();for(var d=0;d<c.length;++d){var e=c[d],f=e.box;if(!e.show)continue;a.push('<div class="'+e.direction+"Axis "+e.direction+e.n+'Axis" style="color:'+e.options.color+'">');for(var g=0;g<e.ticks.length;++g){var h=e.ticks[g];if(!h.label||h.v<e.min||h.v>e.max)continue;var i={},j;if(e.direction=="x"){j="center";i.left=Math.round(q.left+e.p2c(h.v)-e.labelWidth/2);e.position=="bottom"?i.top=f.top+f.padding:i.bottom=s-(f.top+f.height-f.padding)}else{i.top=Math.round(q.top+e.p2c(h.v)-e.labelHeight/2);if(e.position=="left"){i.right=r-(f.left+f.width-f.padding);j="right"}else{i.left=f.left+f.padding;j="left"}}i.width=e.labelWidth;var k=["position:absolute","text-align:"+j];for(var l in i)k.push(l+":"+i[l]+"px");a.push('<div class="tickLabel" style="'+k.join(";")+'">'+h.label+"</div>")}a.push("</div>")}a.push("</div>");b.append(a.join(""))}function cb(a){a.lines.show&&db(a);a.bars.show&&gb(a);a.points.show&&eb(a)}function db(a){function b(a,b,c,d,e){var f=a.points,g=a.pointsize,h=null,i=null;m.beginPath();for(var j=g;j<f.length;j+=g){var k=f[j-g],l=f[j-g+1],n=f[j],o=f[j+1];if(k==null||n==null)continue;if(l<=o&&l<e.min){if(o<e.min)continue;k=(e.min-l)/(o-l)*(n-k)+k;l=e.min}else if(o<=l&&o<e.min){if(l<e.min)continue;n=(e.min-l)/(o-l)*(n-k)+k;o=e.min}if(l>=o&&l>e.max){if(o>e.max)continue;k=(e.max-l)/(o-l)*(n-k)+k;l=e.max}else if(o>=l&&o>e.max){if(l>e.max)continue;n=(e.max-l)/(o-l)*(n-k)+k;o=e.max}if(k<=n&&k<d.min){if(n<d.min)continue;l=(d.min-k)/(n-k)*(o-l)+l;k=d.min}else if(n<=k&&n<d.min){if(k<d.min)continue;o=(d.min-k)/(n-k)*(o-l)+l;n=d.min}if(k>=n&&k>d.max){if(n>d.max)continue;l=(d.max-k)/(n-k)*(o-l)+l;k=d.max}else if(n>=k&&n>d.max){if(k>d.max)continue;o=(d.max-k)/(n-k)*(o-l)+l;n=d.max}(k!=h||l!=i)&&m.moveTo(d.p2c(k)+b,e.p2c(l)+c);h=n;i=o;m.lineTo(d.p2c(n)+b,e.p2c(o)+c)}m.stroke()}function c(a,b,c){var d=a.points,e=a.pointsize,f=Math.min(Math.max(0,c.min),c.max),g=0,h,i=!1,j=1,k=0,l=0;for(;;){if(e>0&&g>d.length+e)break;g+=e;var n=d[g-e],o=d[g-e+j],p=d[g],q=d[g+j];if(i){if(e>0&&n!=null&&p==null){l=g;e=-e;j=2;continue}if(e<0&&g==k+e){m.fill();i=!1;e=-e;j=1;g=k=l+e;continue}}if(n==null||p==null)continue;if(n<=p&&n<b.min){if(p<b.min)continue;o=(b.min-n)/(p-n)*(q-o)+o;n=b.min}else if(p<=n&&p<b.min){if(n<b.min)continue;q=(b.min-n)/(p-n)*(q-o)+o;p=b.min}if(n>=p&&n>b.max){if(p>b.max)continue;o=(b.max-n)/(p-n)*(q-o)+o;n=b.max}else if(p>=n&&p>b.max){if(n>b.max)continue;q=(b.max-n)/(p-n)*(q-o)+o;p=b.max}if(!i){m.beginPath();m.moveTo(b.p2c(n),c.p2c(f));i=!0}if(o>=c.max&&q>=c.max){m.lineTo(b.p2c(n),c.p2c(c.max));m.lineTo(b.p2c(p),c.p2c(c.max));continue}if(o<=c.min&&q<=c.min){m.lineTo(b.p2c(n),c.p2c(c.min));m.lineTo(b.p2c(p),c.p2c(c.min));continue}var r=n,s=p;if(o<=q&&o<c.min&&q>=c.min){n=(c.min-o)/(q-o)*(p-n)+n;o=c.min}else if(q<=o&&q<c.min&&o>=c.min){p=(c.min-o)/(q-o)*(p-n)+n;q=c.min}if(o>=q&&o>c.max&&q<=c.max){n=(c.max-o)/(q-o)*(p-n)+n;o=c.max}else if(q>=o&&q>c.max&&o<=c.max){p=(c.max-o)/(q-o)*(p-n)+n;q=c.max}n!=r&&m.lineTo(b.p2c(r),c.p2c(o));m.lineTo(b.p2c(n),c.p2c(o));m.lineTo(b.p2c(p),c.p2c(q));if(p!=s){m.lineTo(b.p2c(p),c.p2c(q));m.lineTo(b.p2c(s),c.p2c(q))}}}m.save();m.translate(q.left,q.top);m.lineJoin="round";var d=a.lines.lineWidth,e=a.shadowSize;if(d>0&&e>0){m.lineWidth=e;m.strokeStyle="rgba(0,0,0,0.1)";var f=Math.PI/18;b(a.datapoints,Math.sin(f)*(d/2+e/2),Math.cos(f)*(d/2+e/2),a.xaxis,a.yaxis);m.lineWidth=e/2;b(a.datapoints,Math.sin(f)*(d/2+e/4),Math.cos(f)*(d/2+e/4),a.xaxis,a.yaxis)}m.lineWidth=d;m.strokeStyle=a.color;var g=hb(a.lines,a.color,0,u);if(g){m.fillStyle=g;c(a.datapoints,a.xaxis,a.yaxis)}d>0&&b(a.datapoints,0,0,a.xaxis,a.yaxis);m.restore()}function eb(a){function b(a,b,c,d,e,f,g,h){var i=a.points,j=a.pointsize;for(var k=0;k<i.length;k+=j){var l=i[k],n=i[k+1];if(l==null||l<f.min||l>f.max||n<g.min||n>g.max)continue;m.beginPath();l=f.p2c(l);n=g.p2c(n)+d;h=="circle"?m.arc(l,n,b,0,e?Math.PI:Math.PI*2,!1):h(m,l,n,b,e);m.closePath();if(c){m.fillStyle=c;m.fill()}m.stroke()}}m.save();m.translate(q.left,q.top);var c=a.points.lineWidth,d=a.shadowSize,e=a.points.radius,f=a.points.symbol;if(c>0&&d>0){var g=d/2;m.lineWidth=g;m.strokeStyle="rgba(0,0,0,0.1)";b(a.datapoints,e,null,g+g/2,!0,a.xaxis,a.yaxis,f);m.strokeStyle="rgba(0,0,0,0.2)";b(a.datapoints,e,null,g/2,!0,a.xaxis,a.yaxis,f)}m.lineWidth=c;m.strokeStyle=a.color;b(a.datapoints,e,hb(a.points,a.color),0,!1,a.xaxis,a.yaxis,f);m.restore()}function fb(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p,q,r,s,t,u;if(k){t=r=s=!0;q=!1;m=c;n=a;p=b+d;o=b+e;if(n<m){u=n;n=m;m=u;q=!0;r=!1}}else{q=r=s=!0;t=!1;m=a+d;n=a+e;o=c;p=b;if(p<o){u=p;p=o;o=u;t=!0;s=!1}}if(n<h.min||m>h.max||p<i.min||o>i.max)return;if(m<h.min){m=h.min;q=!1}if(n>h.max){n=h.max;r=!1}if(o<i.min){o=i.min;t=!1}if(p>i.max){p=i.max;s=!1}m=h.p2c(m);o=i.p2c(o);n=h.p2c(n);p=i.p2c(p);if(g){j.beginPath();j.moveTo(m,o);j.lineTo(m,p);j.lineTo(n,p);j.lineTo(n,o);j.fillStyle=g(o,p);j.fill()}if(l>0&&(q||r||s||t)){j.beginPath();j.moveTo(m,o+f);q?j.lineTo(m,p+f):j.moveTo(m,p+f);s?j.lineTo(n,p+f):j.moveTo(n,p+f);r?j.lineTo(n,o+f):j.moveTo(n,o+f);t?j.lineTo(m,o+f):j.moveTo(m,o+f);j.stroke()}}function gb(a){function b(b,c,d,e,f,g,h){var i=b.points,j=b.pointsize;for(var k=0;k<i.length;k+=j){if(i[k]==null)continue;fb(i[k],i[k+1],i[k+2],c,d,e,f,g,h,m,a.bars.horizontal,a.bars.lineWidth)}}m.save();m.translate(q.left,q.top);m.lineWidth=a.bars.lineWidth;m.strokeStyle=a.color;var c=a.bars.align=="left"?0:-a.bars.barWidth/2,d=a.bars.fill?function(b,c){return hb(a.bars,a.color,b,c)}:null;b(a.datapoints,c,c+a.bars.barWidth,0,d,a.xaxis,a.yaxis);m.restore()}function hb(b,c,d,e){var f=b.fill;if(!f)return null;if(b.fillColor)return xb(b.fillColor,d,e,c);var g=a.color.parse(c);g.a=typeof f=="number"?f:.4;g.normalize();return g.toString()}function ib(){b.find(".legend").remove();if(!h.legend.show)return;var c=[],d=!1,e=h.legend.labelFormatter,f,i;for(var j=0;j<g.length;++j){f=g[j];i=f.label;if(!i)continue;if(j%h.legend.noColumns==0){d&&c.push("</tr>");c.push("<tr>");d=!0}e&&(i=e(i,f));c.push('<td class="legendColorBox"><div style="border:1px solid '+h.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+f.color+';overflow:hidden"></div></div></td>'+'<td class="legendLabel">'+i+"</td>")}d&&c.push("</tr>");if(c.length==0)return;var k='<table style="font-size:smaller;color:'+h.grid.color+'">'+c.join("")+"</table>";if(h.legend.container!=null)a(h.legend.container).html(k);else{var l="",m=h.legend.position,n=h.legend.margin;n[0]==null&&(n=[n,n]);m.charAt(0)=="n"?l+="top:"+(n[1]+q.top)+"px;":m.charAt(0)=="s"&&(l+="bottom:"+(n[1]+q.bottom)+"px;");m.charAt(1)=="e"?l+="right:"+(n[0]+q.right)+"px;":m.charAt(1)=="w"&&(l+="left:"+(n[0]+q.left)+"px;");var o=a('<div class="legend">'+k.replace('style="','style="position:absolute;'+l+";")+"</div>").appendTo(b);if(h.legend.backgroundOpacity!=0){var p=h.legend.backgroundColor;if(p==null){p=h.grid.backgroundColor;p&&typeof p=="string"?p=a.color.parse(p):p=a.color.extract(o,"background-color");p.a=1;p=p.toString()}var r=o.children();a('<div style="position:absolute;width:'+r.width()+"px;height:"+r.height()+"px;"+l+"background-color:"+p+';"> </div>').prependTo(o).css("opacity",h.legend.backgroundOpacity)}}}function lb(a,b,c){var d=h.grid.mouseActiveRadius,e=d*d+1,f=null,i=!1,j,k;for(j=g.length-1;j>=0;--j){if(!c(g[j]))continue;var l=g[j],m=l.xaxis,n=l.yaxis,o=l.datapoints.points,p=l.datapoints.pointsize,q=m.c2p(a),r=n.c2p(b),s=d/m.scale,t=d/n.scale;m.options.inverseTransform&&(s=Number.MAX_VALUE);n.options.inverseTransform&&(t=Number.MAX_VALUE);if(l.lines.show||l.points.show)for(k=0;k<o.length;k+=p){var u=o[k],v=o[k+1];if(u==null)continue;if(u-q>s||u-q<-s||v-r>t||v-r<-t)continue;var w=Math.abs(m.p2c(u)-a),x=Math.abs(n.p2c(v)-b),y=w*w+x*x;if(y<e){e=y;f=[j,k/p]}}if(l.bars.show&&!f){var z=l.bars.align=="left"?0:-l.bars.barWidth/2,A=z+l.bars.barWidth;for(k=0;k<o.length;k+=p){var u=o[k],v=o[k+1],B=o[k+2];if(u==null)continue;if(g[j].bars.horizontal?q<=Math.max(B,u)&&q>=Math.min(B,u)&&r>=v+z&&r<=v+A:q>=u+z&&q<=u+A&&r>=Math.min(B,v)&&r<=Math.max(B,v))f=[j,k/p]}}}if(f){j=f[0];k=f[1];p=g[j].datapoints.pointsize;return{datapoint:g[j].datapoints.points.slice(k*p,(k+1)*p),dataIndex:k,series:g[j],seriesIndex:j}}return null}function mb(a){h.grid.hoverable&&pb("plothover",a,function(a){return a["hoverable"]!=0})}function nb(a){h.grid.hoverable&&pb("plothover",a,function(a){return!1})}function ob(a){pb("plotclick",a,function(a){return a["clickable"]!=0})}function pb(a,c,d){var e=l.offset(),f=c.pageX-e.left-q.left,g=c.pageY-e.top-q.top,i=E({left:f,top:g});i.pageX=c.pageX;i.pageY=c.pageY;var j=lb(f,g,d);if(j){j.pageX=parseInt(j.series.xaxis.p2c(j.datapoint[0])+e.left+q.left);j.pageY=parseInt(j.series.yaxis.p2c(j.datapoint[1])+e.top+q.top)}if(h.grid.autoHighlight){for(var k=0;k<jb.length;++k){var m=jb[k];m.auto==a&&(!j||m.series!=j.series||m.point[0]!=j.datapoint[0]||m.point[1]!=j.datapoint[1])&&tb(m.series,m.point)}j&&sb(j.series,j.datapoint,a)}b.trigger(a,[i,j])}function qb(){kb||(kb=setTimeout(rb,30))}function rb(){kb=null;n.save();n.clearRect(0,0,r,s);n.translate(q.left,q.top);var a,b;for(a=0;a<jb.length;++a){b=jb[a];b.series.bars.show?wb(b.series,b.point):vb(b.series,b.point)}n.restore();x(v.drawOverlay,[n])}function sb(a,b,c){typeof a=="number"&&(a=g[a]);if(typeof b=="number"){var d=a.datapoints.pointsize;b=a.datapoints.points.slice(d*b,d*(b+1))}var e=ub(a,b);if(e==-1){jb.push({series:a,point:b,auto:c});qb()}else c||(jb[e].auto=!1)}function tb(a,b){if(a==null&&b==null){jb=[];qb()}typeof a=="number"&&(a=g[a]);typeof b=="number"&&(b=a.data[b]);var c=ub(a,b);if(c!=-1){jb.splice(c,1);qb()}}function ub(a,b){for(var c=0;c<jb.length;++c){var d=jb[c];if(d.series==a&&d.point[0]==b[0]&&d.point[1]==b[1])return c}return-1}function vb(b,c){var d=c[0],e=c[1],f=b.xaxis,g=b.yaxis;if(d<f.min||d>f.max||e<g.min||e>g.max)return;var h=b.points.radius+b.points.lineWidth/2;n.lineWidth=h;n.strokeStyle=a.color.parse(b.color).scale("a",.5).toString();var i=1.5*h,d=f.p2c(d),e=g.p2c(e);n.beginPath();b.points.symbol=="circle"?n.arc(d,e,i,0,2*Math.PI,!1):b.points.symbol(n,d,e,i,!1);n.closePath();n.stroke()}function wb(b,c){n.lineWidth=b.bars.lineWidth;n.strokeStyle=a.color.parse(b.color).scale("a",.5).toString();var d=a.color.parse(b.color).scale("a",.5).toString(),e=b.bars.align=="left"?0:-b.bars.barWidth/2;fb(c[0],c[1],c[2]||0,e,e+b.bars.barWidth,0,function(){return d},b.xaxis,b.yaxis,n,b.bars.horizontal,b.bars.lineWidth)}function xb(b,c,d,e){if(typeof b=="string")return b;var f=m.createLinearGradient(0,d,0,c);for(var g=0,h=b.colors.length;g<h;++g){var i=b.colors[g];if(typeof i!="string"){var j=a.color.parse(e);i.brightness!=null&&(j=j.scale("rgb",i.brightness));i.opacity!=null&&(j.a*=i.opacity);i=j.toString()}f.addColorStop(g/(h-1),i)}return f}var g=[],h={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85},xaxis:{show:null,position:"bottom",mode:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null,monthNames:null,timeformat:null,twelveHourClock:!1},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1},shadowSize:3},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},hooks:{}},j=null,k=null,l=null,m=null,n=null,o=[],p=[],q={left:0,right:0,top:0,bottom:0},r=0,s=0,t=0,u=0,v={processOptions:[],processRawData:[],processDatapoints:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},w=this;w.setData=A;w.setupGrid=T;w.draw=Y;w.getPlaceholder=function(){return b};w.getCanvas=function(){return j};w.getPlotOffset=function(){return q};w.width=function(){return t};w.height=function(){return u};w.offset=function(){var a=l.offset();a.left+=q.left;a.top+=q.top;return a};w.getData=function(){return g};w.getAxes=function(){var b={},c;a.each(o.concat(p),function(a,c){c&&(b[c.direction+(c.n!=1?c.n:"")+"axis"]=c)});return b};w.getXAxes=function(){return o};w.getYAxes=function(){return p};w.c2p=E;w.p2c=F;w.getOptions=function(){return h};w.highlight=sb;w.unhighlight=tb;w.triggerRedrawOverlay=qb;w.pointOffset=function(a){return{left:parseInt(o[C(a,"x")-1].p2c(+a.x)+q.left),top:parseInt(p[C(a,"y")-1].p2c(+a.y)+q.top)}};w.shutdown=O;w.resize=function(){K();L(j);L(k)};w.hooks=v;y(w);z(e);M();A(d);T();Y();N();var jb=[],kb=null}function c(a,b){return b*Math.floor(a/b)}a.plot=function(c,d,e){var f=new b(a(c),d,e,a.plot.plugins);return f};a.plot.version="0.7";a.plot.plugins=[];a.plot.formatDate=function(a,b,c){var d=function(a){a=""+a;return a.length==1?"0"+a:a},e=[],f=!1,g=!1,h=a.getUTCHours(),i=h<12;c==null&&(c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]);b.search(/%p|%P/)!=-1&&(h>12?h-=12:h==0&&(h=12));for(var j=0;j<b.length;++j){var k=b.charAt(j);if(f){switch(k){case"h":k=""+h;break;case"H":k=d(h);break;case"M":k=d(a.getUTCMinutes());break;case"S":k=d(a.getUTCSeconds());break;case"d":k=""+a.getUTCDate();break;case"m":k=""+(a.getUTCMonth()+1);break;case"y":k=""+a.getUTCFullYear();break;case"b":k=""+c[a.getUTCMonth()];break;case"p":k=i?"am":"pm";break;case"P":k=i?"AM":"PM";break;case"0":k="";g=!0}if(k&&g){k=d(k);g=!1}e.push(k);g||(f=!1)}else k=="%"?f=!0:e.push(k)}return e.join("")}})(jQuery);(function(a){function c(a){function b(a,b){var c=null;for(var d=0;d<b.length;++d){if(a==b[d])break;b[d].stack==a.stack&&(c=b[d])}return c}function c(a,c,d){if(c.stack==null)return;var e=b(c,a.getData());if(!e)return;var f=d.pointsize,g=d.points,h=e.datapoints.pointsize,i=e.datapoints.points,j=[],k,l,n,o,p,q,r=c.lines.show,s=c.bars.horizontal,t=f>2&&(s?d.format[2].x:d.format[2].y),u=r&&c.lines.steps,v=!0,w=s?1:0,x=s?0:1,y=0,z=0,A;for(;;){if(y>=g.length)break;A=j.length;if(g[y]==null){for(m=0;m<f;++m)j.push(g[y+m]);y+=f}else if(z>=i.length){if(!r)for(m=0;m<f;++m)j.push(g[y+m]);y+=f}else if(i[z]==null){for(m=0;m<f;++m)j.push(null);v=!0;z+=h}else{k=g[y+w];l=g[y+x];o=i[z+w];p=i[z+x];q=0;if(k==o){for(m=0;m<f;++m)j.push(g[y+m]);j[A+x]+=p;q=p;y+=f;z+=h}else if(k>o){if(r&&y>0&&g[y-f]!=null){n=l+(g[y-f+x]-l)*(o-k)/(g[y-f+w]-k);j.push(o);j.push(n+p);for(m=2;m<f;++m)j.push(g[y+m]);q=p}z+=h}else{if(v&&r){y+=f;continue}for(m=0;m<f;++m)j.push(g[y+m]);r&&z>0&&i[z-h]!=null&&(q=p+(i[z-h+x]-p)*(k-o)/(i[z-h+w]-o));j[A+x]+=q;y+=f}v=!1;A!=j.length&&t&&(j[A+2]+=q)}if(u&&A!=j.length&&A>0&&j[A]!=null&&j[A]!=j[A-f]&&j[A+1]!=j[A-f+1]){for(m=0;m<f;++m)j[A+f+m]=j[A+m];j[A+1]=j[A-f+1]}}d.points=j}a.hooks.processDatapoints.push(c)}var b={series:{stack:null}};a.plot.plugins.push({init:c,options:b,name:"stack",version:"1.2"})})(jQuery);(function(a){a.widget("ui.selectmenu",{getter:"value",version:"1.9",eventPrefix:"selectmenu",options:{transferClasses:!0,typeAhead:1e3,style:"dropdown",positionOptions:{my:"left top",at:"left bottom",offset:null},width:null,menuWidth:null,handleWidth:26,maxHeight:null,icons:null,format:null,bgImage:function(){},wrapperElement:"<div />"},_create:function(){var b=this,c=this.options,d=(this.element.attr("id")||"ui-selectmenu-"+Math.random().toString(16).slice(2,10)).replace(":","\\:");this.ids=[d,d+"-button",d+"-menu"];this._safemouseup=!0;this.isOpen=!1;this.newelement=a("<a />",{"class":this.widgetBaseClass+" ui-widget ui-state-default ui-corner-all",id:this.ids[1],role:"button",href:"#nogo",tabindex:this.element.attr("disabled")?1:0,"aria-haspopup":!0,"aria-owns":this.ids[2]});this.newelementWrap=a(c.wrapperElement).append(this.newelement).insertAfter(this.element);var e=this.element.attr("tabindex");e&&this.newelement.attr("tabindex",e);this.newelement.data("selectelement",this.element);this.selectmenuIcon=a('<span class="'+this.widgetBaseClass+'-icon ui-icon"></span>').prependTo(this.newelement);this.newelement.prepend('<span class="'+b.widgetBaseClass+'-status" />');this.element.bind({"click.selectmenu":function(a){b.newelement.focus();a.preventDefault()}});this.newelement.bind("mousedown.selectmenu",function(a){b._toggle(a,!0);if(c.style=="popup"){b._safemouseup=!1;setTimeout(function(){b._safemouseup=!0},300)}return!1}).bind("click.selectmenu",function(){return!1}).bind("keydown.selectmenu",function(c){var d=!1;switch(c.keyCode){case a.ui.keyCode.ENTER:d=!0;break;case a.ui.keyCode.SPACE:b._toggle(c);break;case a.ui.keyCode.UP:c.altKey?b.open(c):b._moveSelection(-1);break;case a.ui.keyCode.DOWN:c.altKey?b.open(c):b._moveSelection(1);break;case a.ui.keyCode.LEFT:b._moveSelection(-1);break;case a.ui.keyCode.RIGHT:b._moveSelection(1);break;case a.ui.keyCode.TAB:d=!0;break;case a.ui.keyCode.HOME:b.index(0);break;default:d=!0}return d}).bind("keypress.selectmenu",function(a){a.which>0&&b._typeAhead(a.which,"mouseup");return!0}).bind("mouseover.selectmenu focus.selectmenu",function(){c.disabled||a(this).addClass(b.widgetBaseClass+"-focus ui-state-hover")}).bind("mouseout.selectmenu blur.selectmenu",function(){c.disabled||a(this).removeClass(b.widgetBaseClass+"-focus ui-state-hover")});a(document).bind("mousedown.selectmenu-"+this.ids[0],function(a){b.isOpen&&b.close(a)});this.element.bind("click.selectmenu",function(){b._refreshValue()}).bind("focus.selectmenu",function(){b.newelement&&b.newelement[0].focus()});c.width||(c.width=this.element.outerWidth());this.newelement.width(c.width);this.element.hide();this.list=a("<ul />",{"class":"ui-widget ui-widget-content","aria-hidden":!0,role:"listbox","aria-labelledby":this.ids[1],id:this.ids[2]});this.listWrap=a(c.wrapperElement).addClass(b.widgetBaseClass+"-menu").append(this.list).appendTo("body");this.list.bind("keydown.selectmenu",function(c){var d=!1;switch(c.keyCode){case a.ui.keyCode.UP:c.altKey?b.close(c,!0):b._moveFocus(-1);break;case a.ui.keyCode.DOWN:c.altKey?b.close(c,!0):b._moveFocus(1);break;case a.ui.keyCode.LEFT:b._moveFocus(-1);break;case a.ui.keyCode.RIGHT:b._moveFocus(1);break;case a.ui.keyCode.HOME:b._moveFocus(":first");break;case a.ui.keyCode.PAGE_UP:b._scrollPage("up");break;case a.ui.keyCode.PAGE_DOWN:b._scrollPage("down");break;case a.ui.keyCode.END:b._moveFocus(":last");break;case a.ui.keyCode.ENTER:case a.ui.keyCode.SPACE:b.close(c,!0);a(c.target).parents("li:eq(0)").trigger("mouseup");break;case a.ui.keyCode.TAB:d=!0;b.close(c,!0);a(c.target).parents("li:eq(0)").trigger("mouseup");break;case a.ui.keyCode.ESCAPE:b.close(c,!0);break;default:d=!0}return d}).bind("keypress.selectmenu",function(a){a.which>0&&b._typeAhead(a.which,"focus");return!0}).bind("mousedown.selectmenu mouseup.selectmenu",function(){return!1});a(window).bind("resize.selectmenu-"+this.ids[0],a.proxy(b.close,this))},_init:function(){var b=this,c=this.options,d=[];this.element.find("option").each(function(){var e=a(this);d.push({value:e.attr("value"),text:b._formatText(e.text()),selected:e.attr("selected"),disabled:e.attr("disabled"),classes:e.attr("class"),typeahead:e.attr("typeahead"),parentOptGroup:e.parent("optgroup"),bgImage:c.bgImage.call(e)})});var e=b.options.style=="popup"?" ui-state-active":"";this.list.html("");if(d.length)for(var f=0;f<d.length;f++){var g={role:"presentation"};d[f].disabled&&(g["class"]=this.namespace+"-state-disabled");var h={html:d[f].text,href:"#nogo",tabindex:-1,role:"option","aria-selected":!1};d[f].disabled&&(h["aria-disabled"]=d[f].disabled);d[f].typeahead&&(h.typeahead=d[f].typeahead);var i=a("<a/>",h),j=a("<li/>",g).append(i).data("index",f).addClass(d[f].classes).data("optionClasses",d[f].classes||"").bind("mouseup.selectmenu",function(c){if(b._safemouseup&&!b._disabled(c.currentTarget)&&!b._disabled(a(c.currentTarget).parents("ul>li."+b.widgetBaseClass+"-group "))){var d=a(this).data("index")!=b._selectedIndex();b.index(a(this).data("index"));b.select(c);d&&b.change(c);b.close(c,!0)}return!1}).bind("click.selectmenu",function(){return!1}).bind("mouseover.selectmenu focus.selectmenu",function(c){if(!a(c.currentTarget).hasClass(b.namespace+"-state-disabled")&&!a(c.currentTarget).parent("ul").parent("li").hasClass(b.namespace+"-state-disabled")){b._selectedOptionLi().addClass(e);b._focusedOptionLi().removeClass(b.widgetBaseClass+"-item-focus ui-state-hover");a(this).removeClass("ui-state-active").addClass(b.widgetBaseClass+"-item-focus ui-state-hover")}}).bind("mouseout.selectmenu blur.selectmenu",function(){a(this).is(b._selectedOptionLi().selector)&&a(this).addClass(e);a(this).removeClass(b.widgetBaseClass+"-item-focus ui-state-hover")});if(d[f].parentOptGroup.length){var k=b.widgetBaseClass+"-group-"+this.element.find("optgroup").index(d[f].parentOptGroup);this.list.find("li."+k).length?this.list.find("li."+k+":last ul").append(j):a(' <li role="presentation" class="'+b.widgetBaseClass+"-group "+k+(d[f].parentOptGroup.attr("disabled")?" "+this.namespace+'-state-disabled" aria-disabled="true"':'"')+'><span class="'+b.widgetBaseClass+'-group-label">'+d[f].parentOptGroup.attr("label")+"</span><ul></ul></li> ").appendTo(this.list).find("ul").append(j)}else j.appendTo(this.list);if(c.icons)for(var l in c.icons)if(j.is(c.icons[l].find)){j.data("optionClasses",d[f].classes+" "+b.widgetBaseClass+"-hasIcon").addClass(b.widgetBaseClass+"-hasIcon");var m=c.icons[l].icon||"";j.find("a:eq(0)").prepend('<span class="'+b.widgetBaseClass+"-item-icon ui-icon "+m+'"></span>');d[f].bgImage&&j.find("span").css("background-image",d[f].bgImage)}}else a('<li role="presentation"><a href="#nogo" tabindex="-1" role="option"></a></li>').appendTo(this.list);var n=c.style=="dropdown";this.newelement.toggleClass(b.widgetBaseClass+"-dropdown",n).toggleClass(b.widgetBaseClass+"-popup",!n);this.list.toggleClass(b.widgetBaseClass+"-menu-dropdown ui-corner-bottom",n).toggleClass(b.widgetBaseClass+"-menu-popup ui-corner-all",!n).find("li:first").toggleClass("ui-corner-top",!n).end().find("li:last").addClass("ui-corner-bottom");this.selectmenuIcon.toggleClass("ui-icon-triangle-1-s",n).toggleClass("ui-icon-triangle-2-n-s",!n);if(c.transferClasses){var o=this.element.attr("class")||"";this.newelement.add(this.list).addClass(o)}c.style=="dropdown"?this.list.width(c.menuWidth?c.menuWidth:c.width):this.list.width(c.menuWidth?c.menuWidth:c.width-c.handleWidth);this.list.css("height","auto");var p=this.listWrap.height();if(c.maxHeight&&c.maxHeight<p)this.list.height(c.maxHeight);else{var q=a(window).height()/3;q<p&&this.list.height(q)}this._optionLis=this.list.find("li:not(."+b.widgetBaseClass+"-group)");this.element.attr("disabled")?this.disable():this.enable();this.index(this._selectedIndex());window.setTimeout(function(){b._refreshPosition()},200)},destroy:function(){this.element.removeData(this.widgetName).removeClass(this.widgetBaseClass+"-disabled"+" "+this.namespace+"-state-disabled").removeAttr("aria-disabled").unbind(".selectmenu");a(window).unbind(".selectmenu-"+this.ids[0]);a(document).unbind(".selectmenu-"+this.ids[0]);this.newelementWrap.remove();this.listWrap.remove();this.element.unbind(".selectmenu").show();a.Widget.prototype.destroy.apply(this,arguments)},_typeAhead:function(a,b){var c=this,d=String.fromCharCode(a).toLowerCase(),e=this.list.find("li a"),f=null,g=null;if(c._typeAhead_timer){window.clearTimeout(c._typeAhead_timer);c._typeAhead_timer=undefined}c._typeAhead_chars=(c._typeAhead_chars===undefined?"":c._typeAhead_chars).concat(d);if(c._typeAhead_chars.length<2||c._typeAhead_chars.substr(-2,1)===d&&c._typeAhead_cycling){c._typeAhead_cycling=!0;f=d}else{c._typeAhead_cycling=!1;f=c._typeAhead_chars}var h=(b!=="focus"?this._selectedOptionLi().data("index"):this._focusedOptionLi().data("index"))||0;for(var i=0;i<e.length;i++){var j=e.eq(i).text().substr(0,f.length).toLowerCase();if(j===f)if(c._typeAhead_cycling){g===null&&(g=i);if(i>h){g=i;break}}else g=i}g!==null&&e.eq(g).trigger(b);c._typeAhead_timer=window.setTimeout(function(){c._typeAhead_timer=undefined;c._typeAhead_chars=undefined;c._typeAhead_cycling=undefined},c.options.typeAhead)},_uiHash:function(){var b=this.index();return{index:b,option:a("option",this.element).get(b),value:this.element[0].value}},open:function(a){var b=this,c=this.options;if(b.newelement.attr("aria-disabled")!="true"){b._closeOthers(a);b.newelement.addClass("ui-state-active");b.listWrap.appendTo(c.appendTo);b.list.attr("aria-hidden",!1);b.listWrap.addClass(b.widgetBaseClass+"-open");var d=this._selectedOptionLi();c.style=="dropdown"?b.newelement.removeClass("ui-corner-all").addClass("ui-corner-top"):this.list.css("left",-5e3).scrollTop(this.list.scrollTop()+d.position().top-this.list.outerHeight()/2+d.outerHeight()/2).css("left","auto");b._refreshPosition();var e=d.find("a");e.length&&e[0].focus();b.isOpen=!0;b._trigger("open",a,b._uiHash())}},close:function(a,b){if(this.newelement.is(".ui-state-active")){this.newelement.removeClass("ui-state-active");this.listWrap.removeClass(this.widgetBaseClass+"-open");this.list.attr("aria-hidden",!0);this.options.style=="dropdown"&&this.newelement.removeClass("ui-corner-top").addClass("ui-corner-all");b&&this.newelement.focus();this.isOpen=!1;this._trigger("close",a,this._uiHash())}},change:function(a){this.element.trigger("change");this._trigger("change",a,this._uiHash())},select:function(a){if(this._disabled(a.currentTarget))return!1;this._trigger("select",a,this._uiHash())},_closeOthers:function(b){a("."+this.widgetBaseClass+".ui-state-active").not(this.newelement).each(function(){a(this).data("selectelement").selectmenu("close",b)});a("."+this.widgetBaseClass+".ui-state-hover").trigger("mouseout")},_toggle:function(a,b){this.isOpen?this.close(a,b):this.open(a)},_formatText:function(a){return this.options.format?this.options.format(a):a},_selectedIndex:function(){return this.element[0].selectedIndex},_selectedOptionLi:function(){return this._optionLis.eq(this._selectedIndex())},_focusedOptionLi:function(){return this.list.find("."+this.widgetBaseClass+"-item-focus")},_moveSelection:function(a,b){if(!this.options.disabled){var c=parseInt(this._selectedOptionLi().data("index")||0,10),d=c+a;d<0&&(d=0);d>this._optionLis.size()-1&&
(d=this._optionLis.size()-1);if(d===b)return!1;if(!this._optionLis.eq(d).hasClass(this.namespace+"-state-disabled"))return this._optionLis.eq(d).trigger("mouseup");a>0?++a:--a;this._moveSelection(a,d)}},_moveFocus:function(a,b){if(!isNaN(a))var c=parseInt(this._focusedOptionLi().data("index")||0,10),d=c+a;else var d=parseInt(this._optionLis.filter(a).data("index"),10);d<0&&(d=0);d>this._optionLis.size()-1&&(d=this._optionLis.size()-1);if(d===b)return!1;var e=this.widgetBaseClass+"-item-"+Math.round(Math.random()*1e3);this._focusedOptionLi().find("a:eq(0)").attr("id","");if(this._optionLis.eq(d).hasClass(this.namespace+"-state-disabled")){a>0?++a:--a;this._moveFocus(a,d)}else this._optionLis.eq(d).find("a:eq(0)").attr("id",e).focus();this.list.attr("aria-activedescendant",e)},_scrollPage:function(a){var b=Math.floor(this.list.outerHeight()/this.list.find("li:first").outerHeight());b=a=="up"?-b:b;this._moveFocus(b)},_setOption:function(a,b){this.options[a]=b;if(a=="disabled"){b&&this.close();this.element.add(this.newelement).add(this.list)[b?"addClass":"removeClass"](this.widgetBaseClass+"-disabled"+" "+this.namespace+"-state-disabled").attr("aria-disabled",b)}},disable:function(a,b){typeof a=="undefined"?this._setOption("disabled",!0):b=="optgroup"?this._disableOptgroup(a):this._disableOption(a)},enable:function(a,b){typeof a=="undefined"?this._setOption("disabled",!1):b=="optgroup"?this._enableOptgroup(a):this._enableOption(a)},_disabled:function(b){return a(b).hasClass(this.namespace+"-state-disabled")},_disableOption:function(a){var b=this._optionLis.eq(a);if(b){b.addClass(this.namespace+"-state-disabled").find("a").attr("aria-disabled",!0);this.element.find("option").eq(a).attr("disabled","disabled")}},_enableOption:function(a){var b=this._optionLis.eq(a);if(b){b.removeClass(this.namespace+"-state-disabled").find("a").attr("aria-disabled",!1);this.element.find("option").eq(a).removeAttr("disabled")}},_disableOptgroup:function(a){var b=this.list.find("li."+this.widgetBaseClass+"-group-"+a);if(b){b.addClass(this.namespace+"-state-disabled").attr("aria-disabled",!0);this.element.find("optgroup").eq(a).attr("disabled","disabled")}},_enableOptgroup:function(a){var b=this.list.find("li."+this.widgetBaseClass+"-group-"+a);if(b){b.removeClass(this.namespace+"-state-disabled").attr("aria-disabled",!1);this.element.find("optgroup").eq(a).removeAttr("disabled")}},index:function(b){if(!arguments.length)return this._selectedIndex();if(!!this._disabled(a(this._optionLis[b])))return!1;this.element[0].selectedIndex=b;this._refreshValue()},value:function(a){if(!arguments.length)return this.element[0].value;this.element[0].value=a;this._refreshValue()},_refreshValue:function(){var a=this.options.style=="popup"?" ui-state-active":"",b=this.widgetBaseClass+"-item-"+Math.round(Math.random()*1e3);this.list.find("."+this.widgetBaseClass+"-item-selected").removeClass(this.widgetBaseClass+"-item-selected"+a).find("a").attr("aria-selected","false").attr("id","");this._selectedOptionLi().addClass(this.widgetBaseClass+"-item-selected"+a).find("a").attr("aria-selected","true").attr("id",b);var c=this.newelement.data("optionClasses")?this.newelement.data("optionClasses"):"",d=this._selectedOptionLi().data("optionClasses")?this._selectedOptionLi().data("optionClasses"):"";this.newelement.removeClass(c).data("optionClasses",d).addClass(d).find("."+this.widgetBaseClass+"-status").html(this._selectedOptionLi().find("a:eq(0)").html());this.list.attr("aria-activedescendant",b)},_refreshPosition:function(){var a=this.options;if(a.style=="popup"&&!a.positionOptions.offset)var b=this._selectedOptionLi(),c="0 "+(this.list.offset().top-b.offset().top-(this.newelement.outerHeight()+b.outerHeight())/2);this.listWrap.zIndex(this.element.zIndex()+1).position({of:a.positionOptions.of||this.newelement,my:a.positionOptions.my,at:a.positionOptions.at,offset:a.positionOptions.offset||c,collision:a.positionOptions.collision||"flip"})}})})(jQuery);(function($){$.fn.editable=function(a,b){var c={target:a,name:"value",id:"id",type:"text",width:"auto",height:"auto",event:"click",onblur:"cancel",loadtype:"GET",loadtext:"Loading...",placeholder:"Click to edit",loaddata:{},submitdata:{},ajaxoptions:{}};b&&$.extend(c,b);var d=$.editable.types[c.type].plugin||function(){},e=$.editable.types[c.type].submit||function(){},f=$.editable.types[c.type].buttons||$.editable.types.defaults.buttons,g=$.editable.types[c.type].content||$.editable.types.defaults.content,h=$.editable.types[c.type].element||$.editable.types.defaults.element,i=$.editable.types[c.type].reset||$.editable.types.defaults.reset,j=c.callback||function(){},k=c.onsubmit||function(){},l=c.onreset||function(){},m=c.onerror||i;$.isFunction($(this)[c.event])||($.fn[c.event]=function(a){return a?this.bind(c.event,a):this.trigger(c.event)});$(this).attr("title",c.tooltip);c.autowidth="auto"==c.width;c.autoheight="auto"==c.height;return this.each(function(){var a=this,b=$(a).width(),n=$(a).height();$.trim($(this).html())||$(this).html(c.placeholder);$(this)[c.event](function(l){if(a.editing)return;$(a).removeAttr("title");if(0==$(a).width()){c.width=b;c.height=n}else{c.width!="none"&&(c.width=c.autowidth?$(a).width():c.width);c.height!="none"&&(c.height=c.autoheight?$(a).height():c.height)}$(this).html().toLowerCase().replace(/;/,"")==c.placeholder.toLowerCase().replace(/;/,"")&&$(this).html("");a.editing=!0;a.revert=$(a).html();$(a).html("");var o=$("<form />");c.cssclass&&("inherit"==c.cssclass?o.attr("class",$(a).attr("class")):o.attr("class",c.cssclass));if(c.style)if("inherit"==c.style){o.attr("style",$(a).attr("style"));o.css("display",$(a).css("display"))}else o.attr("style",c.style);var p=h.apply(o,[c,a]),q;if(c.loadurl){var r=setTimeout(function(){p.disabled=!0;g.apply(o,[c.loadtext,c,a])},100),s={};s[c.id]=a.id;$.isFunction(c.loaddata)?$.extend(s,c.loaddata.apply(a,[a.revert,c])):$.extend(s,c.loaddata);$.ajax({type:c.loadtype,url:c.loadurl,data:s,async:!1,success:function(a){window.clearTimeout(r);q=a;p.disabled=!1}})}else if(c.data){q=c.data;$.isFunction(c.data)&&(q=c.data.apply(a,[a.revert,c]))}else q=a.revert;g.apply(o,[q,c,a]);p.attr("name",c.name);f.apply(o,[c,a]);$(a).append(o);d.apply(o,[c,a]);$(":input:visible:enabled:first",o).focus();c.select&&p.select();p.keydown(function(b){if(b.keyCode==27){b.preventDefault();i.apply(o,[c,a])}});var r;"cancel"==c.onblur?p.blur(function(b){r=setTimeout(function(){i.apply(o,[c,a])},500)}):"submit"==c.onblur?p.blur(function(a){r=setTimeout(function(){o.submit()},200)}):$.isFunction(c.onblur)?p.blur(function(b){c.onblur.apply(a,[p.val(),c])}):p.blur(function(a){});o.submit(function(b){r&&clearTimeout(r);b.preventDefault();if(!1!==k.apply(o,[c,a])&&!1!==e.apply(o,[c,a]))if($.isFunction(c.target)){var d=c.target.apply(a,[p.val(),c]);$(a).html(d);a.editing=!1;j.apply(a,[a.innerHTML,c]);$.trim($(a).html())||$(a).html(c.placeholder)}else{var f={};f[c.name]=p.val();f[c.id]=a.id;$.isFunction(c.submitdata)?$.extend(f,c.submitdata.apply(a,[a.revert,c])):$.extend(f,c.submitdata);"PUT"==c.method&&(f._method="put");$(a).html(c.indicator);var g={type:"POST",data:f,url:c.target,success:function(b,d){$(a).html(b);a.editing=!1;j.apply(a,[a.innerHTML,c]);$.trim($(a).html())||$(a).html(c.placeholder)},error:function(b,d,e){m.apply(o,[c,a,b])}};$.extend(g,c.ajaxoptions);$.ajax(g)}$(a).attr("title",c.tooltip);return!1})});this.reset=function(b){if(this.editing&&!1!==l.apply(b,[c,a])){$(a).html(a.revert);a.editing=!1;$.trim($(a).html())||$(a).html(c.placeholder);$(a).attr("title",c.tooltip)}}})};$.editable={types:{defaults:{element:function(a,b){var c=$('<input type="hidden"></input>');$(this).append(c);return c},content:function(a,b,c){$(":input:first",this).val(a)},reset:function(a,b){b.reset(this)},buttons:function(a,b){var c=this;if(a.submit){if(a.submit.match(/>$/))var d=$(a.submit).click(function(){d.attr("type")!="submit"&&c.submit()});else{var d=$('<button type="submit" />');d.html(a.submit)}$(this).append(d)}if(a.cancel){if(a.cancel.match(/>$/))var e=$(a.cancel);else{var e=$('<button type="cancel" />');e.html(a.cancel)}$(this).append(e);$(e).click(function(d){if($.isFunction($.editable.types[a.type].reset))var e=$.editable.types[a.type].reset;else var e=$.editable.types.defaults.reset;e.apply(c,[a,b]);return!1})}}},text:{element:function(a,b){var c=$("<input />");a.width!="none"&&c.width(a.width);a.height!="none"&&c.height(a.height);c.attr("autocomplete","off");$(this).append(c);return c}},textarea:{element:function(a,b){var c=$("<textarea />");a.rows?c.attr("rows",a.rows):c.height(a.height);a.cols?c.attr("cols",a.cols):c.width(a.width);$(this).append(c);return c}},select:{element:function(a,b){var c=$("<select />");$(this).append(c);return c},content:function(string,settings,original){if(String==string.constructor){eval("var json = "+string);for(var key in json){if(!json.hasOwnProperty(key))continue;if("selected"==key)continue;var option=$("<option />").val(key).append(json[key]);$("select",this).append(option)}}$("select",this).children().each(function(){($(this).val()==json["selected"]||$(this).text()==original.revert)&&$(this).attr("selected","selected")})}}},addInputType:function(a,b){$.editable.types[a]=b}}})(jQuery);(function(a){a.fn.makeEditable=function(b){function d(b){return o.fnGetRowID(a(b.parentNode))}function e(a,b){a.attr("id",b)}function f(a){return a.attr("id")}function g(b,c){a("td:first",b).html(c)}function h(b){return a("td:first",b).html()}function p(a,b){alert(a)}function q(){i.fnSettings().oFeatures.bProcessing&&a(".dataTables_processing").css("visibility","visible")}function r(){i.fnSettings().oFeatures.bProcessing&&a(".dataTables_processing").css("visibility","hidden")}function v(b){if(o.bDisableEditing)return;var e={event:"dblclick",callback:function(a,b){o.fnEndProcessingMode();var c="";if(t==a){var d=i.fnGetPosition(this);i.fnUpdate(sNewCellDisplayValue,d[0],d[2]);c="success"}else{var d=i.fnGetPosition(this);i.fnUpdate(s,d[0],d[2]);o.fnShowError(a,"update");c="failure"}o.fnOnEdited(c,s,sNewCellDisplayValue,d[0],d[1],d[2]);b.fnOnCellUpdated!=null&&b.fnOnCellUpdated(c,a,b);N()},onsubmit:function(b,c){var d=a("input,select,textarea",this);s=c.revert;t=a("input,select,textarea",a(this)).val();if(d.length==1){var e=d[0];e.nodeName.toLowerCase()=="select"||e.tagName.toLowerCase()=="select"?sNewCellDisplayValue=a("option:selected",e).text():sNewCellDisplayValue=t}if(!o.fnOnEditing(d))return!1;var f=b;if(b.cssclass!=null){d.addClass(b.cssclass);return!d.valid()||0==d.valid()?!1:!0}},submitdata:function(a,b){c=M();o.fnStartProcessingMode();var e=d(this),f=i.fnGetPosition(this)[0],g=i.fnGetPosition(this)[1],h=i.fnGetPosition(this)[2],j=i.fnSettings().aoColumns[h].sName;if(j==null||j=="")j=i.fnSettings().aoColumns[h].sTitle;return{id:e,rowId:f,columnPosition:g,columnId:h,columnName:j}},onerror:function(){o.fnEndProcessingMode();o.fnShowError("Cell cannot be updated(Server error)","update");o.fnOnEdited("failure")},height:o.sEditorHeight,width:o.sEditorWidth},f=null;if(o.aoColumns!=null){for(var g=0;g<o.aoColumns.length;g++)if(o.aoColumns[g]!=null){f=a("td:nth-child("+(g+1)+")",b);var h=e;h=a.extend({},e,o.aoColumns[g]);var j=o.sUpdateURL;try{h.sUpdateURL!=null&&(j=h.sUpdateURL)}catch(k){}f.editable(j,h)}}else{f=a("td:not(."+o.sReadOnlyCellClass+")",b);f.editable(o.sUpdateURL,e)}}function w(b){if(o.fnOnAdding()&&n.valid()){c=M();o.fnStartProcessingMode();var d=n.serialize();a.ajax({url:o.sAddURL,data:d,type:o.sAddHttpMethod,dataType:"text",success:y,error:function(a){o.fnEndProcessingMode();o.fnShowError(a.responseText,"add");o.fnOnAdded("failure")}})}b.stopPropagation();b.preventDefault()}function x(a){return!0}function y(b){o.fnEndProcessingMode();if(o.fnOnNewRowPosted(b)){var c=i.fnSettings(),d=c.aoColumns.length,e=new Array;a("input:text[rel],input:radio[rel][checked],input:hidden[rel],select[rel],textarea[rel],span.datafield[rel]",n).each(function(){var c=a(this).attr("rel"),f="";if(c>=d)o.fnShowError("In the add form is placed input element with the name '"+a(this).attr("name")+"' with the 'rel' attribute that must be less than a column count - "+d,"add");else{this.nodeName.toLowerCase()=="select"||this.tagName.toLowerCase()=="select"?f=a("option:selected",this).text():this.nodeName.toLowerCase()=="span"||this.tagName.toLowerCase()=="span"?f=a(this).html():f=this.value;f=f.replace(o.sIDToken,b);e[c]=f}});var f=i.fnAddData(e),g=i.fnGetNodes(f);v(g);o.fnSetRowID(a(g),b);n.dialog("close");a(n)[0].reset();a(".error",a(n)).html("");N();o.fnOnAdded("success")}}function z(b){a(n).validate().resetForm();a(n)[0].reset();a(".error",a(n)).html("");a(".error",a(n)).hide();n.dialog("close");b.stopPropagation();b.preventDefault()}function A(){o.oDeleteRowButtonOptions!=null?k.button("option","disabled",!0):k.attr("disabled","true")}function B(){o.oDeleteRowButtonOptions!=null?k.button("option","disabled",!1):k.removeAttr("disabled")}function C(b,c){var d=c;c==null&&(d=o.sDeleteURL);o.fnStartProcessingMode();var e=a.extend(o.oDeleteParameters,{id:b});a.ajax({url:d,type:o.sDeleteHttpMethod,data:e,success:E,dataType:"text",error:function(a){o.fnEndProcessingMode();o.fnShowError(a.responseText,"delete");o.fnOnDeleted("failure")}})}function D(b){c=M();if(a("tr."+o.sSelectedRowClass+" td",i).length==0){A();return}var e=d(a("tr."+o.sSelectedRowClass+" td",i)[0]);o.fnOnDeleting(a("tr."+o.sSelectedRowClass,i),e,C)&&C(e)}function E(b){o.fnEndProcessingMode();var c=a("tr."+o.sSelectedRowClass,i)[0];if(b=="ok"||b==""){i.fnDeleteRow(c);A();N();o.fnOnDeleted("success")}else{o.fnShowError(b,"delete");o.fnOnDeleted("failure")}}function F(a,b,c){return confirm("Are you sure that you want to delete this record?")}function G(a){}function H(a){return!0}function I(a,b,c,d,e,f){}function J(){return!0}function K(a){}function M(){return L._iDisplayStart}function N(){if(L.oFeatures.bServerSide===!1){L._iDisplayStart=c;L.oApi._fnCalculateEnd(L);L.oApi._fnDraw(L)}}var c=0,i,j,k,l,m,n,o,s,t,u,L;i=this;var O={sUpdateURL:"UpdateData",sAddURL:"AddData",sDeleteURL:"DeleteData",sAddNewRowFormId:"formAddNewRow",oAddNewRowFormOptions:{autoOpen:!1,modal:!0},sAddNewRowButtonId:"btnAddNewRow",oAddNewRowButtonOptions:null,sAddNewRowOkButtonId:"btnAddNewRowOk",sAddNewRowCancelButtonId:"btnAddNewRowCancel",oAddNewRowOkButtonOptions:{label:"Ok"},oAddNewRowCancelButtonOptions:{label:"Cancel"},sDeleteRowButtonId:"btnDeleteRow",oDeleteRowButtonOptions:null,sSelectedRowClass:"row_selected",sReadOnlyCellClass:"read_only",sAddDeleteToolbarSelector:".add_delete_toolbar",fnShowError:p,fnStartProcessingMode:q,fnEndProcessingMode:r,aoColumns:null,fnOnDeleting:F,fnOnDeleted:G,fnOnAdding:J,fnOnNewRowPosted:x,fnOnAdded:K,fnOnEditing:H,fnOnEdited:I,sAddHttpMethod:"POST",sDeleteHttpMethod:"POST",fnGetRowID:f,fnSetRowID:e,sEditorHeight:"100%",sEditorWidth:"100%",bDisableEditing:!1,oDeleteParameters:{},sIDToken:"DATAROWID"};o=a.extend(O,b);L=i.fnSettings();return this.each(function(){i.fnSettings().sAjaxSource!=null?i.fnSettings().aoDrawCallback.push({fn:function(){v(i.fnGetNodes());a(i.fnGetNodes()).each(function(){var b=i.fnGetPosition(this),c=i.fnGetData(b)[0];o.fnSetRowID(a(this),c)})},sName:"fnApplyEditable"}):v(i.fnGetNodes());n=a("#"+o.sAddNewRowFormId);if(n.length!=0){o.oAddNewRowFormOptions!=null?o.oAddNewRowFormOptions.autoOpen=!1:o.oAddNewRowFormOptions={autoOpen:!1};n.dialog(o.oAddNewRowFormOptions);j=a("#"+o.sAddNewRowButtonId);if(j.length!=0)j.click(function(){n.dialog("open")});else{if(a(o.sAddDeleteToolbarSelector).length==0)throw"Cannot find a button with an id '"+o.sAddNewRowButtonId+"', od placeholder with an id '"+o.sAddDeleteToolbarSelector+"' that should be used for adding new row although form for adding new record is specified";j=null}if(n[0].nodeName.toLowerCase()=="form"){n.unbind("submit");n.submit(function(a){w(a);return!1})}else{a("form",n[0]).unbind("submit");a("form",n[0]).submit(function(a){w(a);return!1})}var b=[];l=a("#"+o.sAddNewRowOkButtonId,n);if(l.length==0){if(o.oAddNewRowOkButtonOptions.text==null||o.oAddNewRowOkButtonOptions.text=="")o.oAddNewRowOkButtonOptions.text="Ok";o.oAddNewRowOkButtonOptions.click=w;o.oAddNewRowOkButtonOptions.id=o.sAddNewRowOkButtonId;b.push(o.oAddNewRowOkButtonOptions)}else l.click(w);m=a("#"+o.sAddNewRowCancelButtonId);if(m.length==0){if(o.oAddNewRowCancelButtonOptions.text==null||o.oAddNewRowCancelButtonOptions.text=="")o.oAddNewRowCancelButtonOptions.text="Cancel";o.oAddNewRowCancelButtonOptions.click=z;o.oAddNewRowCancelButtonOptions.id=o.sAddNewRowCancelButtonId;b.push(o.oAddNewRowCancelButtonOptions)}else m.click(z);b.length>0&&n.dialog("option","buttons",b);l=a("#"+o.sAddNewRowOkButtonId);m=a("#"+o.sAddNewRowCancelButtonId)}else n=null;k=a("#"+o.sDeleteRowButtonId);k.length!=0?k.click(D):k=null;oAddDeleteToolbar=a(o.sAddDeleteToolbarSelector);if(oAddDeleteToolbar.length!=0){if(j==null&&o.sAddNewRowButtonId!=""&&n!=null){oAddDeleteToolbar.append("<button id='"+o.sAddNewRowButtonId+"' class='add_row'>Add</button>");j=a("#"+o.sAddNewRowButtonId);j.click(function(){n.dialog("open")})}if(k==null&&o.sDeleteRowButtonId!=""){oAddDeleteToolbar.append("<button id='"+o.sDeleteRowButtonId+"' class='delete_row'>Delete</button>");k=a("#"+o.sDeleteRowButtonId);k.click(D)}}if(k!=null){o.oDeleteRowButtonOptions!=null&&k.button(o.oDeleteRowButtonOptions);A()}j!=null&&o.oAddNewRowButtonOptions!=null&&j.button(o.oAddNewRowButtonOptions);l!=null&&o.oAddNewRowOkButtonOptions!=null&&l.button(o.oAddNewRowOkButtonOptions);m!=null&&o.oAddNewRowCancelButtonOptions!=null&&m.button(o.oAddNewRowCancelButtonOptions);a(".table-action-deletelink",i).live("click",function(b){b.preventDefault();b.stopPropagation();var e=a(this).attr("href");if(e==null||e=="")e=o.sDeleteURL;c=M();var f=a(this).parents("td")[0],g=a(this).parents("tr")[0];a(g).addClass(o.sSelectedRowClass);var h=d(f);o.fnOnDeleting(f,h,C)&&C(h,e)});a("tbody",i).click(function(b){if(a(b.target.parentNode).hasClass(o.sSelectedRowClass)){a(b.target.parentNode).removeClass(o.sSelectedRowClass);k!=null&&A()}else{a(i.fnSettings().aoData).each(function(){a(this.nTr).removeClass(o.sSelectedRowClass)});a(b.target.parentNode).addClass(o.sSelectedRowClass);k!=null&&B()}})})}})(jQuery);(function(a,b,c){function Z(c,d,e){var g=b.createElement(c);d&&(g.id=f+d);e&&(g.style.cssText=e);return a(g)}function $(a){var b=y.length,c=(Q+a)%b;return c<0?b+c:c}function _(a,b){return Math.round((/%/.test(a)?(b==="x"?z.width():z.height())/100:1)*parseInt(a,10))}function ab(a){return K.photo||/\.(gif|png|jpe?g|bmp|ico)((#|\?).*)?$/i.test(a)}function bb(){var b,c=a.data(P,e);if(c==null){K=a.extend({},d);console&&console.log&&console.log("Error: cboxElement missing settings object")}else K=a.extend({},c);for(b in K)a.isFunction(K[b])&&b.slice(0,2)!=="on"&&(K[b]=K[b].call(P));K.rel=K.rel||P.rel||"nofollow";K.href=K.href||a(P).attr("href");K.title=K.title||P.title;typeof K.href=="string"&&(K.href=a.trim(K.href))}function cb(b,c){a.event.trigger(b);c&&c.call(P)}function db(){var a,b=f+"Slideshow_",c="click."+f,d,e,g;if(K.slideshow&&y[1]){d=function(){F.text(K.slideshowStop).unbind(c).bind(j,function(){if(K.loop||y[Q+1])a=setTimeout(W.next,K.slideshowSpeed)}).bind(i,function(){clearTimeout(a)}).one(c+" "+k,e);r.removeClass(b+"off").addClass(b+"on");a=setTimeout(W.next,K.slideshowSpeed)};e=function(){clearTimeout(a);F.text(K.slideshowStart).unbind([j,i,k,c].join(" ")).one(c,function(){W.next();d()});r.removeClass(b+"on").addClass(b+"off")};K.slideshowAuto?d():e()}else r.removeClass(b+"off "+b+"on")}function eb(b){if(!U){P=b;bb();y=a(P);Q=0;if(K.rel!=="nofollow"){y=a("."+g).filter(function(){var b=a.data(this,e),c;b&&(c=b.rel||this.rel);return c===K.rel});Q=y.index(P);if(Q===-1){y=y.add(P);Q=y.length-1}}if(!S){S=T=!0;r.show();K.returnFocus&&a(P).blur().one(l,function(){a(this).focus()});q.css({opacity:+K.opacity,cursor:K.overlayClose?"pointer":"auto"}).show();K.w=_(K.initialWidth,"x");K.h=_(K.initialHeight,"y");W.position();o&&z.bind("resize."+p+" scroll."+p,function(){q.css({width:z.width(),height:z.height(),top:z.scrollTop(),left:z.scrollLeft()})}).trigger("resize."+p);cb(h,K.onOpen);J.add(D).hide();I.html(K.close).show()}W.load(!0)}}function fb(){if(!r&&b.body){Y=!1;z=a(c);r=Z(X).attr({id:e,"class":n?f+(o?"IE6":"IE"):""}).hide();q=Z(X,"Overlay",o?"position:absolute":"").hide();s=Z(X,"Wrapper");t=Z(X,"Content").append(A=Z(X,"LoadedContent","width:0; height:0; overflow:hidden"),C=Z(X,"LoadingOverlay").add(Z(X,"LoadingGraphic")),D=Z(X,"Title"),E=Z(X,"Current"),G=Z(X,"Next"),H=Z(X,"Previous"),F=Z(X,"Slideshow").bind(h,db),I=Z(X,"Close"));s.append(Z(X).append(Z(X,"TopLeft"),u=Z(X,"TopCenter"),Z(X,"TopRight")),Z(X,!1,"clear:left").append(v=Z(X,"MiddleLeft"),t,w=Z(X,"MiddleRight")),Z(X,!1,"clear:left").append(Z(X,"BottomLeft"),x=Z(X,"BottomCenter"),Z(X,"BottomRight"))).find("div div").css({"float":"left"});B=Z(X,!1,"position:absolute; width:9999px; visibility:hidden; display:none");J=G.add(H).add(E).add(F);a(b.body).append(q,r.append(s,B))}}function gb(){if(r){if(!Y){Y=!0;L=u.height()+x.height()+t.outerHeight(!0)-t.height();M=v.width()+w.width()+t.outerWidth(!0)-t.width();N=A.outerHeight(!0);O=A.outerWidth(!0);r.css({"padding-bottom":L,"padding-right":M});G.click(function(){W.next()});H.click(function(){W.prev()});I.click(function(){W.close()});q.click(function(){K.overlayClose&&W.close()});a(b).bind("keydown."+f,function(a){var b=a.keyCode;if(S&&K.escKey&&b===27){a.preventDefault();W.close()}if(S&&K.arrowKey&&y[1])if(b===37){a.preventDefault();H.click()}else if(b===39){a.preventDefault();G.click()}});a("."+g,b).live("click",function(a){if(!(a.which>1||a.shiftKey||a.altKey||a.metaKey)){a.preventDefault();eb(this)}})}return!0}return!1}var d={transition:"elastic",speed:300,width:!1,initialWidth:"600",innerWidth:!1,maxWidth:!1,height:!1,initialHeight:"450",innerHeight:!1,maxHeight:!1,scalePhotos:!0,scrolling:!0,inline:!1,html:!1,iframe:!1,fastIframe:!0,photo:!1,href:!1,title:!1,rel:!1,opacity:.9,preloading:!0,current:"image {current} of {total}",previous:"previous",next:"next",close:"close",xhrError:"This content failed to load.",imgError:"This image failed to load.",open:!1,returnFocus:!0,reposition:!0,loop:!0,slideshow:!1,slideshowAuto:!0,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",onOpen:!1,onLoad:!1,onComplete:!1,onCleanup:!1,onClosed:!1,overlayClose:!0,escKey:!0,arrowKey:!0,top:!1,bottom:!1,left:!1,right:!1,fixed:!1,data:undefined},e="colorbox",f="cbox",g=f+"Element",h=f+"_open",i=f+"_load",j=f+"_complete",k=f+"_cleanup",l=f+"_closed",m=f+"_purge",n=!a.support.opacity&&!a.support.style,o=n&&!c.XMLHttpRequest,p=f+"_IE6",q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X="div",Y;if(a.colorbox)return;a(fb);W=a.fn[e]=a[e]=function(b,c){var f=this;b=b||{};fb();if(gb()){if(!f[0]){if(f.selector)return f;f=a("<a/>");b.open=!0}c&&(b.onComplete=c);f.each(function(){a.data(this,e,a.extend({},a.data(this,e)||d,b))}).addClass(g);(a.isFunction(b.open)&&b.open.call(f)||b.open)&&eb(f[0])}return f};W.position=function(a,b){function i(a){u[0].style.width=x[0].style.width=t[0].style.width=a.style.width;t[0].style.height=v[0].style.height=w[0].style.height=a.style.height}var c=0,d=0,e=r.offset(),g,h;z.unbind("resize."+f);r.css({top:-9e4,left:-9e4});g=z.scrollTop();h=z.scrollLeft();if(K.fixed&&!o){e.top-=g;e.left-=h;r.css({position:"fixed"})}else{c=g;d=h;r.css({position:"absolute"})}K.right!==!1?d+=Math.max(z.width()-K.w-O-M-_(K.right,"x"),0):K.left!==!1?d+=_(K.left,"x"):d+=Math.round(Math.max(z.width()-K.w-O-M,0)/2);K.bottom!==!1?c+=Math.max(z.height()-K.h-N-L-_(K.bottom,"y"),0):K.top!==!1?c+=_(K.top,"y"):c+=Math.round(Math.max(z.height()-K.h-N-L,0)/2);r.css({top:e.top,left:e.left});a=r.width()===K.w+O&&r.height()===K.h+N?0:a||0;s[0].style.width=s[0].style.height="9999px";r.dequeue().animate({width:K.w+O,height:K.h+N,top:c,left:d},{duration:a,complete:function(){i(this);T=!1;s[0].style.width=K.w+O+M+"px";s[0].style.height=K.h+N+L+"px";K.reposition&&setTimeout(function(){z.bind("resize."+f,W.position)},1);b&&b()},step:function(){i(this)}})};W.resize=function(a){if(S){a=a||{};a.width&&(K.w=_(a.width,"x")-O-M);a.innerWidth&&(K.w=_(a.innerWidth,"x"));A.css({width:K.w});a.height&&(K.h=_(a.height,"y")-N-L);a.innerHeight&&(K.h=_(a.innerHeight,"y"));if(!a.innerHeight&&!a.height){A.css({height:"auto"});K.h=A.height()}A.css({height:K.h});W.position(K.transition==="none"?0:K.speed)}};W.prep=function(b){function g(){K.w=K.w||A.width();K.w=K.mw&&K.mw<K.w?K.mw:K.w;return K.w}function h(){K.h=K.h||A.height();K.h=K.mh&&K.mh<K.h?K.mh:K.h;return K.h}if(!S)return;var c,d=K.transition==="none"?0:K.speed;A.remove();A=Z(X,"LoadedContent").append(b);A.hide().appendTo(B.show()).css({width:g(),overflow:K.scrolling?"auto":"hidden"}).css({height:h()}).prependTo(t);B.hide();a(R).css({"float":"none"});o&&a("select").not(r.find("select")).filter(function(){return this.style.visibility!=="hidden"}).css({visibility:"hidden"}).one(k,function(){this.style.visibility="inherit"});c=function(){function s(){n&&r[0].style.removeAttribute("filter")}var b,c,g=y.length,h,i="frameBorder",k="allowTransparency",l,o,p,q;if(!S)return;l=function(){clearTimeout(V);C.hide();cb(j,K.onComplete)};n&&R&&A.fadeIn(100);D.html(K.title).add(A).show();if(g>1){typeof K.current=="string"&&E.html(K.current.replace("{current}",Q+1).replace("{total}",g)).show();G[K.loop||Q<g-1?"show":"hide"]().html(K.next);H[K.loop||Q?"show":"hide"]().html(K.previous);K.slideshow&&F.show();if(K.preloading){b=[$(-1),$(1)];while(c=y[b.pop()]){q=a.data(c,e);if(q&&q.href){o=q.href;a.isFunction(o)&&(o=o.call(c))}else o=c.href;if(ab(o)){p=new Image;p.src=o}}}}else J.hide();if(K.iframe){h=Z("iframe")[0];i in h&&(h[i]=0);k in h&&(h[k]="true");h.name=f+ +(new Date);K.fastIframe?l():a(h).one("load",l);h.src=K.href;K.scrolling||(h.scrolling="no");a(h).addClass(f+"Iframe").appendTo(A).one(m,function(){h.src="//about:blank"})}else l();K.transition==="fade"?r.fadeTo(d,1,s):s()};K.transition==="fade"?r.fadeTo(d,0,function(){W.position(0,c)}):W.position(d,c)};W.load=function(b){var c,d,e=W.prep;T=!0;R=!1;P=y[Q];b||bb();cb(m);cb(i,K.onLoad);K.h=K.height?_(K.height,"y")-N-L:K.innerHeight&&_(K.innerHeight,"y");K.w=K.width?_(K.width,"x")-O-M:K.innerWidth&&_(K.innerWidth,"x");K.mw=K.w;K.mh=K.h;if(K.maxWidth){K.mw=_(K.maxWidth,"x")-O-M;K.mw=K.w&&K.w<K.mw?K.w:K.mw}if(K.maxHeight){K.mh=_(K.maxHeight,"y")-N-L;K.mh=K.h&&K.h<K.mh?K.h:K.mh}c=K.href;V=setTimeout(function(){C.show()},100);if(K.inline){Z(X).hide().insertBefore(a(c)[0]).one(m,function(){a(this).replaceWith(A.children())});e(a(c))}else if(K.iframe)e(" ");else if(K.html)e(K.html);else if(ab(c)){a(R=new Image).addClass(f+"Photo").error(function(){K.title=!1;e(Z(X,"Error").html(K.imgError))}).load(function(){var a;R.onload=null;if(K.scalePhotos){d=function(){R.height-=R.height*a;R.width-=R.width*a};if(K.mw&&R.width>K.mw){a=(R.width-K.mw)/R.width;d()}if(K.mh&&R.height>K.mh){a=(R.height-K.mh)/R.height;d()}}K.h&&(R.style.marginTop=Math.max(K.h-R.height,0)/2+"px");if(y[1]&&(K.loop||y[Q+1])){R.style.cursor="pointer";R.onclick=function(){W.next()}}n&&(R.style.msInterpolationMode="bicubic");setTimeout(function(){e(R)},1)});setTimeout(function(){R.src=c},1)}else c&&B.load(c,K.data,function(b,c,d){e(c==="error"?Z(X,"Error").html(K.xhrError):a(this).contents())})};W.next=function(){if(!T&&y[1]&&(K.loop||y[Q+1])){Q=$(1);W.load()}};W.prev=function(){if(!T&&y[1]&&(K.loop||Q)){Q=$(-1);W.load()}};W.close=function(){if(S&&!U){U=!0;S=!1;cb(k,K.onCleanup);z.unbind("."+f+" ."+p);q.fadeTo(200,0);r.stop().fadeTo(300,0,function(){r.add(q).css({opacity:1,cursor:"auto"}).hide();cb(m);A.remove();setTimeout(function(){U=!1;cb(l,K.onClosed)},1)})}};W.remove=function(){a([]).add(r).add(q).remove();r=null;a("."+g).removeData(e).removeClass(g).die()};W.element=function(){return a(P)};W.settings=d})(jQuery,document,this);(function(a){a.gritter={};a.gritter.options={position:"",class_name:"",fade_in_speed:"medium",fade_out_speed:1e3,time:6e3};a.gritter.add=function(a){try{return b.add(a||{})}catch(c){var d="Gritter Error: "+c;typeof console!="undefined"&&console.error?console.error(d,a):alert(d)}};a.gritter.remove=function(a,c){b.removeSpecific(a,c||{})};a.gritter.removeAll=function(a){b.stop(a||{})};var b={position:"",fade_in_speed:"",fade_out_speed:"",time:"",_custom_timer:0,_item_count:0,_is_setup:0,_tpl_close:'<div class="gritter-close"></div>',_tpl_item:'<div id="gritter-item-[[number]]" class="gritter-item-wrapper [[item_class]]" style="display:none"><div class="gritter-top"></div><div class="gritter-item">[[close]][[image]]<div class="[[class_name]]"><span class="gritter-title">[[username]]</span><p>[[text]]</p></div><div style="clear:both"></div></div><div class="gritter-bottom"></div></div>',_tpl_wrap:'<div id="gritter-notice-wrapper"></div>',add:function(c){if(!c.title||!c.text)throw'You need to fill out the first 2 params: "title" and "text"';this._is_setup||this._runSetup();var d=c.title,e=c.text,f=c.image||"",g=c.sticky||!1,h=c.class_name||a.gritter.options.class_name,i=a.gritter.options.position,j=c.time||"";this._verifyWrapper();this._item_count++;var k=this._item_count,l=this._tpl_item;a(["before_open","after_open","before_close","after_close"]).each(function(d,e){b["_"+e+"_"+k]=a.isFunction(c[e])?c[e]:function(){}});this._custom_timer=0;j&&(this._custom_timer=j);var m=f!=""?'<img src="'+f+'" class="gritter-image" />':"",n=f!=""?"gritter-with-image":"gritter-without-image";l=this._str_replace(["[[username]]","[[text]]","[[close]]","[[image]]","[[number]]","[[class_name]]","[[item_class]]"],[d,e,this._tpl_close,m,this._item_count,n,h],l);if(this["_before_open_"+k]()===!1)return!1;a("#gritter-notice-wrapper").addClass(i).append(l);var o=a("#gritter-item-"+this._item_count);o.fadeIn(this.fade_in_speed,function(){b["_after_open_"+k](a(this))});g||this._setFadeTimer(o,k);a(o).bind("mouseenter mouseleave",function(c){c.type=="mouseenter"?g||b._restoreItemIfFading(a(this),k):g||b._setFadeTimer(a(this),k);b._hoverState(a(this),c.type)});a(o).find(".gritter-close").click(function(){b.removeSpecific(k,{},null,!0)});return k},_countRemoveWrapper:function(b,c,d){c.remove();this["_after_close_"+b](c,d);a(".gritter-item-wrapper").length==0&&a("#gritter-notice-wrapper").remove()},_fade:function(a,c,d,e){var d=d||{},f=typeof d.fade!="undefined"?d.fade:!0,g=d.speed||this.fade_out_speed,h=e;this["_before_close_"+c](a,h);e&&a.unbind("mouseenter mouseleave");f?a.animate({opacity:0},g,function(){a.animate({height:0},300,function(){b._countRemoveWrapper(c,a,h)})}):this._countRemoveWrapper(c,a)},_hoverState:function(a,b){if(b=="mouseenter"){a.addClass("hover");a.find(".gritter-close").show()}else{a.removeClass("hover");a.find(".gritter-close").hide()}},removeSpecific:function(b,c,d,e){if(!d)var d=a("#gritter-item-"+b);this._fade(d,b,c||{},e)},_restoreItemIfFading:function(a,b){clearTimeout(this["_int_id_"+b]);a.stop().css({opacity:"",height:""})},_runSetup:function(){for(opt in a.gritter.options)this[opt]=a.gritter.options[opt];this._is_setup=1},_setFadeTimer:function(a,c){var d=this._custom_timer?this._custom_timer:this.time;this["_int_id_"+c]=setTimeout(function(){b._fade(a,c)},d)},stop:function(b){var c=a.isFunction(b.before_close)?b.before_close:function(){},d=a.isFunction(b.after_close)?b.after_close:function(){},e=a("#gritter-notice-wrapper");c(e);e.fadeOut(function(){a(this).remove();d()})},_str_replace:function(a,b,c,d){var e=0,f=0,g="",h="",i=0,j=0,k=[].concat(a),l=[].concat(b),m=c,n=l instanceof Array,o=m instanceof Array;m=[].concat(m);d&&(this.window[d]=0);for(e=0,i=m.length;e<i;e++){if(m[e]==="")continue;for(f=0,j=k.length;f<j;f++){g=m[e]+"";h=n?l[f]!==undefined?l[f]:"":l[0];m[e]=g.split(k[f]).join(h);d&&m[e]!==g&&(this.window[d]+=(g.length-m[e].length)/k[f].length)}}return o?m:m[0]},_verifyWrapper:function(){a("#gritter-notice-wrapper").length==0&&a("body").append(this._tpl_wrap)}}})(jQuery);(function(a){"use strict";function d(){this.controls={bold:{groupIndex:0,visible:!0,tags:["b","strong"],css:{fontWeight:"bold"},tooltip:"Bold",hotkey:{ctrl:1,key:66}},copy:{groupIndex:8,visible:!1,tooltip:"Copy"},createLink:{groupIndex:6,visible:!0,exec:function(){var c=this;a.wysiwyg.controls&&a.wysiwyg.controls.link?a.wysiwyg.controls.link.init(this):a.wysiwyg.autoload?a.wysiwyg.autoload.control("wysiwyg.link.js",function(){c.controls.createLink.exec.apply(c)}):b.error("$.wysiwyg.controls.link not defined. You need to include wysiwyg.link.js file")},tags:["a"],tooltip:"Create link"},unLink:{groupIndex:6,visible:!0,exec:function(){this.editorDoc.execCommand("unlink",!1,null)},tooltip:"Remove link"},cut:{groupIndex:8,visible:!1,tooltip:"Cut"},decreaseFontSize:{groupIndex:9,visible:!1,tags:["small"],tooltip:"Decrease font size",exec
:function(){this.decreaseFontSize()}},h1:{groupIndex:7,visible:!0,className:"h1",command:a.browser.msie||a.browser.safari?"FormatBlock":"heading",arguments:a.browser.msie||a.browser.safari?"<h1>":"h1",tags:["h1"],tooltip:"Header 1"},h2:{groupIndex:7,visible:!0,className:"h2",command:a.browser.msie||a.browser.safari?"FormatBlock":"heading",arguments:a.browser.msie||a.browser.safari?"<h2>":"h2",tags:["h2"],tooltip:"Header 2"},h3:{groupIndex:7,visible:!0,className:"h3",command:a.browser.msie||a.browser.safari?"FormatBlock":"heading",arguments:a.browser.msie||a.browser.safari?"<h3>":"h3",tags:["h3"],tooltip:"Header 3"},highlight:{tooltip:"Highlight",className:"highlight",groupIndex:1,visible:!1,css:{backgroundColor:"rgb(255, 255, 102)"},exec:function(){var b,c,d,e;a.browser.msie||a.browser.safari?b="backcolor":b="hilitecolor";if(a.browser.msie)c=this.getInternalRange().parentElement();else{d=this.getInternalSelection();c=d.extentNode||d.focusNode;while(c.style===undefined){c=c.parentNode;if(c.tagName&&c.tagName.toLowerCase()==="body")return}}c.style.backgroundColor==="rgb(255, 255, 102)"||c.style.backgroundColor==="#ffff66"?e="#ffffff":e="#ffff66";this.editorDoc.execCommand(b,!1,e)}},html:{groupIndex:10,visible:!1,exec:function(){var b;this.options.resizeOptions&&a.fn.resizable&&(b=this.element.height());if(this.viewHTML){this.setContent(this.original.value);a(this.original).hide();this.editor.show();if(this.options.resizeOptions&&a.fn.resizable){b===this.element.height()&&this.element.height(b+this.editor.height());this.element.resizable(a.extend(!0,{alsoResize:this.editor},this.options.resizeOptions))}this.ui.toolbar.find("li").each(function(){var b=a(this);b.hasClass("html")?b.removeClass("active"):b.removeClass("disabled")})}else{this.saveContent();a(this.original).css({width:this.element.outerWidth()-6,height:this.element.height()-this.ui.toolbar.height()-6,resize:"none"}).show();this.editor.hide();if(this.options.resizeOptions&&a.fn.resizable){b===this.element.height()&&this.element.height(this.ui.toolbar.height());this.element.resizable("destroy")}this.ui.toolbar.find("li").each(function(){var b=a(this);b.hasClass("html")?b.addClass("active"):!1===b.hasClass("fullscreen")&&b.removeClass("active").addClass("disabled")})}this.viewHTML=!this.viewHTML},tooltip:"View source code"},increaseFontSize:{groupIndex:9,visible:!1,tags:["big"],tooltip:"Increase font size",exec:function(){this.increaseFontSize()}},indent:{groupIndex:2,visible:!0,tooltip:"Indent"},insertHorizontalRule:{groupIndex:6,visible:!0,tags:["hr"],tooltip:"Insert Horizontal Rule"},insertImage:{groupIndex:6,visible:!0,exec:function(){var c=this;a.wysiwyg.controls&&a.wysiwyg.controls.image?a.wysiwyg.controls.image.init(this):a.wysiwyg.autoload?a.wysiwyg.autoload.control("wysiwyg.image.js",function(){c.controls.insertImage.exec.apply(c)}):b.error("$.wysiwyg.controls.image not defined. You need to include wysiwyg.image.js file")},tags:["img"],tooltip:"Insert image"},insertOrderedList:{groupIndex:5,visible:!0,tags:["ol"],tooltip:"Insert Ordered List"},insertTable:{groupIndex:6,visible:!0,exec:function(){var c=this;a.wysiwyg.controls&&a.wysiwyg.controls.table?a.wysiwyg.controls.table(this):a.wysiwyg.autoload?a.wysiwyg.autoload.control("wysiwyg.table.js",function(){c.controls.insertTable.exec.apply(c)}):b.error("$.wysiwyg.controls.table not defined. You need to include wysiwyg.table.js file")},tags:["table"],tooltip:"Insert table"},insertUnorderedList:{groupIndex:5,visible:!0,tags:["ul"],tooltip:"Insert Unordered List"},italic:{groupIndex:0,visible:!0,tags:["i","em"],css:{fontStyle:"italic"},tooltip:"Italic",hotkey:{ctrl:1,key:73}},justifyCenter:{groupIndex:1,visible:!0,tags:["center"],css:{textAlign:"center"},tooltip:"Justify Center"},justifyFull:{groupIndex:1,visible:!0,css:{textAlign:"justify"},tooltip:"Justify Full"},justifyLeft:{visible:!0,groupIndex:1,css:{textAlign:"left"},tooltip:"Justify Left"},justifyRight:{groupIndex:1,visible:!0,css:{textAlign:"right"},tooltip:"Justify Right"},ltr:{groupIndex:10,visible:!1,exec:function(){var b=this.dom.getElement("p");if(!b)return!1;a(b).attr("dir","ltr");return!0},tooltip:"Left to Right"},outdent:{groupIndex:2,visible:!0,tooltip:"Outdent"},paragraph:{groupIndex:7,visible:!1,className:"paragraph",command:"FormatBlock",arguments:a.browser.msie||a.browser.safari?"<p>":"p",tags:["p"],tooltip:"Paragraph"},paste:{groupIndex:8,visible:!1,tooltip:"Paste"},redo:{groupIndex:4,visible:!0,tooltip:"Redo"},removeFormat:{groupIndex:10,visible:!0,exec:function(){this.removeFormat()},tooltip:"Remove formatting"},rtl:{groupIndex:10,visible:!1,exec:function(){var b=this.dom.getElement("p");if(!b)return!1;a(b).attr("dir","rtl");return!0},tooltip:"Right to Left"},strikeThrough:{groupIndex:0,visible:!0,tags:["s","strike"],css:{textDecoration:"line-through"},tooltip:"Strike-through"},subscript:{groupIndex:3,visible:!0,tags:["sub"],tooltip:"Subscript"},superscript:{groupIndex:3,visible:!0,tags:["sup"],tooltip:"Superscript"},underline:{groupIndex:0,visible:!0,tags:["u"],css:{textDecoration:"underline"},tooltip:"Underline",hotkey:{ctrl:1,key:85}},undo:{groupIndex:4,visible:!0,tooltip:"Undo"},code:{visible:!0,groupIndex:6,tooltip:"Code snippet",exec:function(){var b=this.getInternalRange(),c=a(b.commonAncestorContainer),d=b.commonAncestorContainer.nodeName.toLowerCase();c.parent("code").length?c.unwrap():d!=="body"&&c.wrap("<code/>")}},cssWrap:{visible:!1,groupIndex:6,tooltip:"CSS Wrapper",exec:function(){a.wysiwyg.controls.cssWrap.init(this)}}};this.defaults={html:'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" style="margin:0"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body style="margin:0;">INITIAL_CONTENT</body></html>',debug:!1,controls:{},css:{},events:{},autoGrow:!1,autoSave:!0,brIE:!0,formHeight:270,formWidth:440,iFrameClass:null,initialContent:"<p><br/></p>",maxHeight:1e4,maxLength:0,messages:{nonSelection:"Select the text you wish to link"},toolbarHtml:'<ul role="menu" class="toolbar"></ul>',removeHeadings:!1,replaceDivWithP:!1,resizeOptions:!1,rmUnusedControls:!1,rmUnwantedBr:!0,tableFiller:"Lorem ipsum",initialMinHeight:null,controlImage:{forceRelativeUrls:!1},controlLink:{forceRelativeUrls:!1},plugins:{autoload:!1,i18n:!1,rmFormat:{rmMsWordMarkup:!1}},dialog:"default"};this.availableControlProperties=["arguments","callback","className","command","css","custom","exec","groupIndex","hotkey","icon","tags","tooltip","visible"];this.editor=null;this.editorDoc=null;this.element=null;this.options={};this.original=null;this.savedRange=null;this.timers=[];this.validKeyCodes=[8,9,13,16,17,18,19,20,27,33,34,35,36,37,38,39,40,45,46];this.isDestroyed=!1;this.dom={ie:{parent:null},w3c:{parent:null}};this.dom.parent=this;this.dom.ie.parent=this.dom;this.dom.w3c.parent=this.dom;this.ui={};this.ui.self=this;this.ui.toolbar=null;this.ui.initialHeight=null;this.dom.getAncestor=function(a,b){b=b.toLowerCase();while(a&&typeof a.tagName!="undefined"&&"body"!==a.tagName.toLowerCase()){if(b===a.tagName.toLowerCase())return a;a=a.parentNode}if(!a.tagName&&(a.previousSibling||a.nextSibling)){if(a.previousSibling&&a.previousSibling.tagName.toLowerCase()==b)return a.previousSibling;if(a.nextSibling&&a.nextSibling.tagName.toLowerCase()==b)return a.nextSibling}return null};this.dom.getElement=function(a){var b=this;a=a.toLowerCase();return window.getSelection?b.w3c.getElement(a):b.ie.getElement(a)};this.dom.ie.getElement=function(a){var b=this.parent,c=b.parent.getInternalSelection(),d=c.createRange(),e;if("Control"===c.type){if(1!==d.length)return null;e=d.item(0)}else e=d.parentElement();return b.getAncestor(e,a)};this.dom.w3c.getElement=function(a){var b=this.parent,c=b.parent.getInternalRange(),d;if(!c)return null;d=c.commonAncestorContainer;3===d.nodeType&&(d=d.parentNode);d===c.startContainer&&(d=d.childNodes[c.startOffset]);if(!d.tagName&&(d.previousSibiling||d.nextSibling)){if(d.previousSibiling&&d.previousSibiling.tagName.toLowerCase()==a)return d.previousSibiling;if(d.nextSibling&&d.nextSibling.tagName.toLowerCase()==a)return d.nextSibling}return b.getAncestor(d,a)};this.ui.addHoverClass=function(){a(this).addClass("wysiwyg-button-hover")};this.ui.appendControls=function(){var b=this,c=this.self,d=c.parseControls(),e=!0,f=[],g={},h,i,j=function(a,c){if(c.groupIndex&&i!==c.groupIndex){i=c.groupIndex;e=!1}if(!c.visible)return;if(!e){b.appendItemSeparator();e=!0}c.custom?b.appendItemCustom(a,c):b.appendItem(a,c)};a.each(d,function(a,b){var c="empty";undefined!==b.groupIndex&&(""===b.groupIndex?c="empty":c=b.groupIndex);if(undefined===g[c]){f.push(c);g[c]={}}g[c][a]=b});f.sort(function(a,b){if("number"==typeof a&&typeof a==typeof b)return a-b;a=a.toString();b=b.toString();return a>b?1:a===b?0:-1});0<f.length&&(i=f[0]);for(h=0;h<f.length;h+=1)a.each(g[f[h]],j)};this.ui.appendItem=function(b,c){var d=this.self,e=c.className||c.command||b||"empty",f=c.tooltip||c.command||b||"";return a('<li role="menuitem" unselectable="on">'+e+"</li>").addClass(e).attr("title",f).hover(this.addHoverClass,this.removeHoverClass).click(function(e){if(a(this).hasClass("disabled"))return!1;d.triggerControl.apply(d,[b,c]);var f=a(e.target);for(var g in d.controls)if(f.hasClass(g)){d.ui.toolbar.find("."+g).toggleClass("active");d.editorDoc.rememberCommand=!0;break}this.blur();d.ui.returnRange();d.ui.focus();return!0}).appendTo(d.ui.toolbar)};this.ui.appendItemCustom=function(b,c){var d=this.self,e=c.tooltip||c.command||b||"";c.callback&&a(window).bind("trigger-"+b+".wysiwyg",c.callback);return a('<li role="menuitem" unselectable="on" style="background: url(\''+c.icon+"') no-repeat;\"></li>").addClass("custom-command-"+b).addClass("wysiwyg-custom-command").addClass(b).attr("title",e).hover(this.addHoverClass,this.removeHoverClass).click(function(){if(a(this).hasClass("disabled"))return!1;d.triggerControl.apply(d,[b,c]);this.blur();d.ui.returnRange();d.ui.focus();d.triggerControlCallback(b);return!0}).appendTo(d.ui.toolbar)};this.ui.appendItemSeparator=function(){var b=this.self;return a('<li role="separator" class="separator"></li>').appendTo(b.ui.toolbar)};this.autoSaveFunction=function(){this.saveContent()};this.ui.checkTargets=function(b){var c=this.self;a.each(c.options.controls,function(d,e){var f=e.className||e.command||d||"empty",g,h,i,j,k=function(a,b){var d;if("function"==typeof b){d=b;d(j.css(a).toString().toLowerCase(),c)&&c.ui.toolbar.find("."+f).addClass("active")}else j.css(a).toString().toLowerCase()===b&&c.ui.toolbar.find("."+f).addClass("active")};"fullscreen"!==f&&c.ui.toolbar.find("."+f).removeClass("active");if(e.tags||e.options&&e.options.tags){g=e.tags||e.options&&e.options.tags;h=b;while(h){if(h.nodeType!==1)break;a.inArray(h.tagName.toLowerCase(),g)!==-1&&c.ui.toolbar.find("."+f).addClass("active");h=h.parentNode}}if(e.css||e.options&&e.options.css){i=e.css||e.options&&e.options.css;j=a(b);while(j){if(j[0].nodeType!==1)break;a.each(i,k);j=j.parent()}}})};this.ui.designMode=function(){var a=3,b=this.self,c;c=function(a){if("on"===b.editorDoc.designMode){b.timers.designMode&&window.clearTimeout(b.timers.designMode);b.innerDocument()!==b.editorDoc&&b.ui.initFrame();return}try{b.editorDoc.designMode="on"}catch(d){}a-=1;a>0&&(b.timers.designMode=window.setTimeout(function(){c(a)},100))};c(a)};this.destroy=function(){this.isDestroyed=!0;var b,c=this.element.closest("form");for(b=0;b<this.timers.length;b+=1)window.clearTimeout(this.timers[b]);c.unbind(".wysiwyg");this.element.remove();a.removeData(this.original,"wysiwyg");a(this.original).show();return this};this.getRangeText=function(){var a=this.getInternalRange();a.toString?a=a.toString():a.text&&(a=a.text);return a};this.execute=function(a,b){typeof b=="undefined"&&(b=null);this.editorDoc.execCommand(a,!1,b)};this.extendOptions=function(b){var c={};if("object"==typeof b.controls){c=b.controls;delete b.controls}b=a.extend(!0,{},this.defaults,b);b.controls=a.extend(!0,{},c,this.controls,c);b.rmUnusedControls&&a.each(b.controls,function(a){c[a]||delete b.controls[a]});return b};this.ui.focus=function(){var a=this.self;a.editor.get(0).contentWindow.focus();return a};this.ui.returnRange=function(){var a=this.self,c;if(a.savedRange!==null){if(window.getSelection){c=window.getSelection();c.rangeCount>0&&c.removeAllRanges();try{c.addRange(a.savedRange)}catch(d){b.error(d)}}else window.document.createRange?window.getSelection().addRange(a.savedRange):window.document.selection&&a.savedRange.select();a.savedRange=null}};this.increaseFontSize=function(){if(a.browser.mozilla||a.browser.opera)this.editorDoc.execCommand("increaseFontSize",!1,null);else if(a.browser.safari){var c=this.getInternalRange(),d=this.getInternalSelection(),e=this.editorDoc.createElement("big");if(!0===c.collapsed&&3===c.commonAncestorContainer.nodeType){var f=c.commonAncestorContainer.nodeValue.toString(),g=f.lastIndexOf(" ",c.startOffset)+1,h=-1===f.indexOf(" ",c.startOffset)?f:f.indexOf(" ",c.startOffset);c.setStart(c.commonAncestorContainer,g);c.setEnd(c.commonAncestorContainer,h);c.surroundContents(e);d.addRange(c)}else{c.surroundContents(e);d.removeAllRanges();d.addRange(c)}}else b.error("Internet Explorer?")};this.decreaseFontSize=function(){if(a.browser.mozilla||a.browser.opera)this.editorDoc.execCommand("decreaseFontSize",!1,null);else if(a.browser.safari){var c=this.getInternalRange(),d=this.getInternalSelection(),e=this.editorDoc.createElement("small");if(!0===c.collapsed&&3===c.commonAncestorContainer.nodeType){var f=c.commonAncestorContainer.nodeValue.toString(),g=f.lastIndexOf(" ",c.startOffset)+1,h=-1===f.indexOf(" ",c.startOffset)?f:f.indexOf(" ",c.startOffset);c.setStart(c.commonAncestorContainer,g);c.setEnd(c.commonAncestorContainer,h);c.surroundContents(e);d.addRange(c)}else{c.surroundContents(e);d.removeAllRanges();d.addRange(c)}}else b.error("Internet Explorer?")};this.getContent=function(){this.viewHTML&&this.setContent(this.original.value);return this.events.filter("getContent",this.editorDoc.body.innerHTML)};this.events={_events:{},bind:function(a,b){typeof this._events.eventName!="object"&&(this._events[a]=[]);this._events[a].push(b)},trigger:function(b,c){if(typeof this._events.eventName=="object"){var d=this.editor;a.each(this._events[b],function(a,b){typeof b=="function"&&b.apply(d,c)})}},filter:function(b,c){if(typeof this._events[b]=="object"){var d=this.editor,e=Array.prototype.slice.call(arguments,1);a.each(this._events[b],function(a,b){typeof b=="function"&&(c=b.apply(d,e))})}return c}};this.getElementByAttributeValue=function(b,c,d){var e,f,g=this.editorDoc.getElementsByTagName(b);for(e=0;e<g.length;e+=1){f=g[e].getAttribute(c);a.browser.msie&&(f=f.substr(f.length-d.length));if(f===d)return g[e]}return!1};this.getInternalRange=function(){var a=this.getInternalSelection();return a?a.rangeCount&&a.rangeCount>0?a.getRangeAt(0):a.createRange?a.createRange():null:null};this.getInternalSelection=function(){if(this.editor.get(0).contentWindow){if(this.editor.get(0).contentWindow.getSelection)return this.editor.get(0).contentWindow.getSelection();if(this.editor.get(0).contentWindow.selection)return this.editor.get(0).contentWindow.selection}return this.editorDoc.getSelection?this.editorDoc.getSelection():this.editorDoc.selection?this.editorDoc.selection:null};this.getRange=function(){var a=this.getSelection();if(!a)return null;if(a.rangeCount&&a.rangeCount>0)a.getRangeAt(0);else if(a.createRange)return a.createRange();return null};this.getSelection=function(){return window.getSelection?window.getSelection():window.document.selection};this.ui.grow=function(){var b=this.self,c=a(b.editorDoc.body),d=a.browser.msie?c[0].scrollHeight:c.height()+2+20,e=b.ui.initialHeight,f=Math.max(d,e);f=Math.min(f,b.options.maxHeight);b.editor.attr("scrolling",f<b.options.maxHeight?"no":"auto");c.css("overflow",f<b.options.maxHeight?"hidden":"");b.editor.get(0).height=f;return b};this.init=function(b,c){var d=this,e=a(b).closest("form"),f=b.width||b.clientWidth||0,g=b.height||b.clientHeight||0;this.options=this.extendOptions(c);this.original=b;this.ui.toolbar=a(this.options.toolbarHtml);a.browser.msie&&parseInt(a.browser.version,10)<8&&(this.options.autoGrow=!1);f===0&&b.cols&&(f=b.cols*8+21);g===0&&b.rows&&(g=b.rows*16+16);this.editor=a(window.location.protocol==="https:"?'<iframe src="javascript:false;"></iframe>':"<iframe></iframe>").attr("frameborder","0");if(this.options.iFrameClass)this.editor.addClass(this.options.iFrameClass);else{this.editor.css({minHeight:(g-6).toString()+"px",width:f>50?(f-8).toString()+"px":""});a.browser.msie&&parseInt(a.browser.version,10)<7&&this.editor.css("height",g.toString()+"px")}if(b.id){var h=b.id+"-wysiwyg-iframe";document.getElementById(h)||this.editor.attr("id",h)}this.editor.attr("tabindex",a(b).attr("tabindex"));this.element=a("<div/>").addClass("wysiwyg");this.options.iFrameClass||this.element.css({width:f>0?f.toString()+"px":"100%"});a(b).hide().before(this.element);this.viewHTML=!1;this.initialContent=a(b).val();this.ui.initFrame();this.options.resizeOptions&&a.fn.resizable&&this.element.resizable(a.extend(!0,{alsoResize:this.editor},this.options.resizeOptions));this.options.autoSave&&e.bind("submit.wysiwyg",function(){d.autoSaveFunction()});e.bind("reset.wysiwyg",function(){d.resetFunction()})};this.ui.initFrame=function(){var c=this.self,d,e,f;c.ui.appendControls();c.element.append(c.ui.toolbar).append(a("<div><!-- --></div>").css({clear:"both"})).append(c.editor);c.editorDoc=c.innerDocument();if(c.isDestroyed)return null;c.ui.designMode();c.editorDoc.open();c.editorDoc.write(c.options.html.replace(/INITIAL_CONTENT/,function(){return c.wrapInitialContent()}));c.editorDoc.close();a.wysiwyg.plugin.bind(c);a(c.editorDoc).trigger("initFrame.wysiwyg");a(c.editorDoc).bind("click.wysiwyg",function(a){c.ui.checkTargets(a.target?a.target:a.srcElement)});setInterval(function(){var d=null;try{var e=c.getInternalRange();e&&(d={range:e,parent:a.browser.msie?e.parentElement():e.endContainer.parentNode,width:(a.browser.msie?e.boundingWidth:e.startOffset-e.endOffset)||0})}catch(f){b.error(f)}d&&d.width==0&&!c.editorDoc.rememberCommand&&c.ui.checkTargets(d.parent)},400);a(c.original).focus(function(){if(a(this).filter(":visible").length===0)return;c.ui.focus()});a(c.editorDoc).keydown(function(a){var b;if(a.keyCode===8){b=/^<([\w]+)[^>]*>(<br\/?>)?<\/\1>$/;if(b.test(c.getContent())){a.stopPropagation();return!1}}c.editorDoc.rememberCommand=!1;return!0});a.browser.msie?c.options.brIE&&a(c.editorDoc).keydown(function(a){if(a.keyCode===13){var b=c.getRange();b.pasteHTML("<br/>");b.collapse(!1);b.select();return!1}return!0}):a(c.editorDoc).keydown(function(a){var b,d;if(a.ctrlKey||a.metaKey)for(b in c.options.controls){d=c.options.controls[b];if(d.hotkey&&d.hotkey.ctrl&&a.keyCode===d.hotkey.key){c.triggerControl.apply(c,[b,d]);return!1}}return!0});c.options.plugins.rmFormat.rmMsWordMarkup&&a(c.editorDoc).bind("keyup.wysiwyg",function(b){(b.ctrlKey||b.metaKey)&&86===b.keyCode&&a.wysiwyg.rmFormat&&("object"==typeof c.options.plugins.rmFormat.rmMsWordMarkup?a.wysiwyg.rmFormat.run(c,{rules:{msWordMarkup:c.options.plugins.rmFormat.rmMsWordMarkup}}):a.wysiwyg.rmFormat.run(c,{rules:{msWordMarkup:{enabled:!0}}}))});c.options.autoSave&&a(c.editorDoc).keydown(function(){c.autoSaveFunction()}).keyup(function(){c.autoSaveFunction()}).mousedown(function(){c.autoSaveFunction()}).bind(a.support.noCloneEvent?"input.wysiwyg":"paste.wysiwyg",function(){c.autoSaveFunction()});if(c.options.autoGrow){c.options.initialMinHeight!==null?c.ui.initialHeight=c.options.initialMinHeight:c.ui.initialHeight=a(c.editorDoc).height();a(c.editorDoc.body).css("border","1px solid white");e=function(){c.ui.grow()};a(c.editorDoc).keyup(e);a(c.editorDoc).bind("editorRefresh.wysiwyg",e);c.ui.grow()}if(c.options.css)if(String===c.options.css.constructor)if(a.browser.msie){d=c.editorDoc.createStyleSheet(c.options.css);a(d).attr({media:"all"})}else{d=a("<link/>").attr({href:c.options.css,media:"all",rel:"stylesheet",type:"text/css"});a(c.editorDoc).find("head").append(d)}else c.timers.initFrame_Css=window.setTimeout(function(){a(c.editorDoc.body).css(c.options.css)},0);c.initialContent.length===0&&("function"==typeof c.options.initialContent?c.setContent(c.options.initialContent()):c.setContent(c.options.initialContent));c.options.maxLength>0&&a(c.editorDoc).keydown(function(b){a(c.editorDoc).text().length>=c.options.maxLength&&a.inArray(b.which,c.validKeyCodes)===-1&&b.preventDefault()});a.each(c.options.events,function(b,d){a(c.editorDoc).bind(b+".wysiwyg",function(a){d.apply(c.editorDoc,[a,c])})});a.browser.msie?a(c.editorDoc).bind("beforedeactivate.wysiwyg",function(){c.savedRange=c.getInternalRange()}):a(c.editorDoc).bind("blur.wysiwyg",function(){c.savedRange=c.getInternalRange()});a(c.editorDoc.body).addClass("wysiwyg");if(c.options.events&&c.options.events.save){f=c.options.events.save;a(c.editorDoc).bind("keyup.wysiwyg",f);a(c.editorDoc).bind("change.wysiwyg",f);if(a.support.noCloneEvent)a(c.editorDoc).bind("input.wysiwyg",f);else{a(c.editorDoc).bind("paste.wysiwyg",f);a(c.editorDoc).bind("cut.wysiwyg",f)}}if(c.options.xhtml5&&c.options.unicode){var g={ne:8800,le:8804,para:182,xi:958,darr:8595,nu:957,oacute:243,Uacute:218,omega:969,prime:8242,pound:163,igrave:236,thorn:254,forall:8704,emsp:8195,lowast:8727,brvbar:166,alefsym:8501,nbsp:160,delta:948,clubs:9827,lArr:8656,Omega:937,Auml:196,cedil:184,and:8743,plusmn:177,ge:8805,raquo:187,uml:168,equiv:8801,laquo:171,rdquo:8221,Epsilon:917,divide:247,fnof:402,chi:967,Dagger:8225,iacute:237,rceil:8969,sigma:963,Oslash:216,acute:180,frac34:190,lrm:8206,upsih:978,Scaron:352,part:8706,exist:8707,nabla:8711,image:8465,prop:8733,zwj:8205,omicron:959,aacute:225,Yuml:376,Yacute:221,weierp:8472,rsquo:8217,otimes:8855,kappa:954,thetasym:977,harr:8596,Ouml:214,Iota:921,ograve:242,sdot:8901,copy:169,oplus:8853,acirc:226,sup:8835,zeta:950,Iacute:205,Oacute:211,crarr:8629,Nu:925,bdquo:8222,lsquo:8216,apos:39,Beta:914,eacute:233,egrave:232,lceil:8968,Kappa:922,piv:982,Ccedil:199,ldquo:8220,Xi:926,cent:162,uarr:8593,hellip:8230,Aacute:193,ensp:8194,sect:167,Ugrave:217,aelig:230,ordf:170,curren:164,sbquo:8218,macr:175,Phi:934,Eta:919,rho:961,Omicron:927,sup2:178,euro:8364,aring:229,Theta:920,mdash:8212,uuml:252,otilde:245,eta:951,uacute:250,rArr:8658,nsub:8836,agrave:224,notin:8713,ndash:8211,Psi:936,Ocirc:212,sube:8838,szlig:223,micro:181,not:172,sup1:185,middot:183,iota:953,ecirc:234,lsaquo:8249,thinsp:8201,sum:8721,ntilde:241,scaron:353,cap:8745,atilde:227,lang:10216,__replacement:65533,isin:8712,gamma:947,Euml:203,ang:8736,upsilon:965,Ntilde:209,hearts:9829,Alpha:913,Tau:932,spades:9824,dagger:8224,THORN:222,"int":8747,lambda:955,Eacute:201,Uuml:220,infin:8734,rlm:8207,Aring:197,ugrave:249,Egrave:200,Acirc:194,rsaquo:8250,ETH:208,oslash:248,alpha:945,Ograve:210,Prime:8243,mu:956,ni:8715,real:8476,bull:8226,beta:946,icirc:238,eth:240,prod:8719,larr:8592,ordm:186,perp:8869,Gamma:915,reg:174,ucirc:251,Pi:928,psi:968,tilde:732,asymp:8776,zwnj:8204,Agrave:192,deg:176,AElig:198,times:215,Delta:916,sim:8764,Otilde:213,Mu:924,uArr:8657,circ:710,theta:952,Rho:929,sup3:179,diams:9830,tau:964,Chi:935,frac14:188,oelig:339,shy:173,or:8744,dArr:8659,phi:966,iuml:239,Lambda:923,rfloor:8971,iexcl:161,cong:8773,ccedil:231,Icirc:206,frac12:189,loz:9674,rarr:8594,cup:8746,radic:8730,frasl:8260,euml:235,OElig:338,hArr:8660,Atilde:195,Upsilon:933,there4:8756,ouml:246,oline:8254,Ecirc:202,yacute:253,auml:228,permil:8240,sigmaf:962,iquest:191,empty:8709,pi:960,Ucirc:219,supe:8839,Igrave:204,yen:165,rang:10217,trade:8482,lfloor:8970,minus:8722,Zeta:918,sub:8834,epsilon:949,yuml:255,Sigma:931,Iuml:207,ocirc:244};c.events.bind("getContent",function(a){return a.replace(/&(?:amp;)?(?!amp|lt|gt|quot)([a-z][a-z0-9]*);/gi,function(a,b){if(!g[b]){b=b.toLowerCase();g[b]||(b="__replacement")}var c=g[b];return String.fromCharCode(c)})})}a(c.original).trigger("ready.jwysiwyg",[c.editorDoc,c])};this.innerDocument=function(){var a=this.editor.get(0);if(a.nodeName.toLowerCase()==="iframe"){if(a.contentDocument)return a.contentDocument;if(a.contentWindow)return a.contentWindow.document;if(this.isDestroyed)return null;b.error("Unexpected error in innerDocument")}return a};this.insertHtml=function(b){var c,d;if(!b||b.length===0)return this;if(a.browser.msie){this.ui.focus();this.editorDoc.execCommand("insertImage",!1,"#jwysiwyg#");c=this.getElementByAttributeValue("img","src","#jwysiwyg#");c&&a(c).replaceWith(b)}else if(a.browser.mozilla)if(1===a(b).length){d=this.getInternalRange();d.deleteContents();d.insertNode(a(b).get(0))}else this.editorDoc.execCommand("insertHTML",!1,b);else if(!this.editorDoc.execCommand("insertHTML",!1,b)){this.editor.focus();this.editorDoc.execCommand("insertHTML",!1,b)}this.saveContent();return this};this.parseControls=function(){var b=this;a.each(this.options.controls,function(c,d){a.each(d,function(d){if(-1===a.inArray(d,b.availableControlProperties))throw c+'["'+d+'"]: property "'+d+'" not exists in Wysiwyg.availableControlProperties'})});return this.options.parseControls?this.options.parseControls.call(this):this.options.controls};this.removeFormat=function(){a.browser.msie&&this.ui.focus();this.options.removeHeadings&&this.editorDoc.execCommand("formatBlock",!1,"<p>");this.editorDoc.execCommand("removeFormat",!1,null);this.editorDoc.execCommand("unlink",!1,null);a.wysiwyg.rmFormat&&a.wysiwyg.rmFormat.enabled&&("object"==typeof this.options.plugins.rmFormat.rmMsWordMarkup?a.wysiwyg.rmFormat.run(this,{rules:{msWordMarkup:this.options.plugins.rmFormat.rmMsWordMarkup}}):a.wysiwyg.rmFormat.run(this,{rules:{msWordMarkup:{enabled:!0}}}));return this};this.ui.removeHoverClass=function(){a(this).removeClass("wysiwyg-button-hover")};this.resetFunction=function(){this.setContent(this.initialContent)};this.saveContent=function(){if(this.viewHTML)return;if(this.original){var b,c;b=this.getContent();this.options.rmUnwantedBr&&(b=b.replace(/<br\/?>$/,""));if(this.options.replaceDivWithP){c=a("<div/>").addClass("temp").append(b);c.children("div").each(function(){var b=a(this),c=b.find("p"),d;if(0===c.length){c=a("<p></p>");if(this.attributes.length>0)for(d=0;d<this.attributes.length;d+=1)c.attr(this.attributes[d].name,b.attr(this.attributes[d].name));c.append(b.html());b.replaceWith(c)}});b=c.html()}a(this.original).val(b);this.options.events&&this.options.events.save&&this.options.events.save.call(this)}return this};this.setContent=function(a){this.editorDoc.body.innerHTML=a;this.saveContent();return this};this.triggerControl=function(a,c){var d=c.command||a,e=c.arguments||[];if(c.exec)c.exec.apply(this);else{this.ui.focus();this.ui.withoutCss();try{this.editorDoc.execCommand(d,!1,e)}catch(f){b.error(f)}}this.options.autoSave&&this.autoSaveFunction()};this.triggerControlCallback=function(b){a(window).trigger("trigger-"+b+".wysiwyg",[this])};this.ui.withoutCss=function(){var b=this.self;if(a.browser.mozilla)try{b.editorDoc.execCommand("styleWithCSS",!1,!1)}catch(c){try{b.editorDoc.execCommand("useCSS",!1,!0)}catch(d){}}return b};this.wrapInitialContent=function(){var a=this.initialContent,b=a.match(/<\/?p>/gi);return b?a:"<p>"+a+"</p>"}}var b=window.console?window.console:{log:a.noop,error:function(b){a.error(b)}},c="prop"in a.fn&&"removeProp"in a.fn;a.wysiwyg={messages:{noObject:"Something goes wrong, check object"},addControl:function(b,c,d){return b.each(function(){var b=a(this).data("wysiwyg"),e={},f;if(!b)return this;e[c]=a.extend(!0,{visible:!0,custom:!0},d);a.extend(!0,b.options.controls,e);f=a(b.options.toolbarHtml);b.ui.toolbar.replaceWith(f);b.ui.toolbar=f;b.ui.appendControls()})},clear:function(b){return b.each(function(){var b=a(this).data("wysiwyg");if(!b)return this;b.setContent("")})},console:b,destroy:function(b){return b.each(function(){var b=a(this).data("wysiwyg");if(!b)return this;b.destroy()})},document:function(b){var c=b.data("wysiwyg");return c?a(c.editorDoc):undefined},getContent:function(a){var b=a.data("wysiwyg");return b?b.getContent():undefined},getSelection:function(a){var b=a.data("wysiwyg");return b?b.getRangeText():undefined},init:function(b,c){return b.each(function(){var b=a.extend(!0,{},c),e;if("textarea"!==this.nodeName.toLowerCase()||a(this).data("wysiwyg"))return;e=new d;e.init(this,b);a.data(this,"wysiwyg",e);a(e.editorDoc).trigger("afterInit.wysiwyg")})},insertHtml:function(b,c){return b.each(function(){var b=a(this).data("wysiwyg");if(!b)return this;b.insertHtml(c)})},plugin:{listeners:{},bind:function(b){var c=this;a.each(this.listeners,function(d,e){var f,g;for(f=0;f<e.length;f+=1){g=c.parseName(e[f]);a(b.editorDoc).bind(d+".wysiwyg",{plugin:g},function(c){a.wysiwyg[c.data.plugin.name][c.data.plugin.method].apply(a.wysiwyg[c.data.plugin.name],[b])})}})},exists:function(b){var c;if("string"!=typeof b)return!1;c=this.parseName(b);return!a.wysiwyg[c.name]||!a.wysiwyg[c.name][c.method]?!1:!0},listen:function(b,c){var d;d=this.parseName(c);if(!a.wysiwyg[d.name]||!a.wysiwyg[d.name][d.method])return!1;this.listeners[b]||(this.listeners[b]=[]);this.listeners[b].push(c);return!0},parseName:function(a){var b;if("string"!=typeof a)return!1;b=a.split(".");return 2>b.length?!1:{name:b[0],method:b[1]}},register:function(c){c.name||b.error("Plugin name missing");a.each(a.wysiwyg,function(a){a===c.name&&b.error("Plugin with name '"+c.name+"' was already registered")});a.wysiwyg[c.name]=c;return!0}},removeFormat:function(b){return b.each(function(){var b=a(this).data("wysiwyg");if(!b)return this;b.removeFormat()})},save:function(b){return b.each(function(){var b=a(this).data("wysiwyg");if(!b)return this;b.saveContent()})},selectAll:function(a){var b=a.data("wysiwyg"),c,d,e;if(!b)return this;c=b.editorDoc.body;if(window.getSelection){e=b.getInternalSelection();e.selectAllChildren(c)}else{d=c.createTextRange();d.moveToElementText(c);d.select()}},setContent:function(b,c){return b.each(function(){var b=a(this).data("wysiwyg");if(!b)return this;b.setContent(c)})},triggerControl:function(c,d){return c.each(function(){var c=a(this).data("wysiwyg");if(!c)return this;c.controls[d]||b.error("Control '"+d+"' not exists");c.triggerControl.apply(c,[d,c.controls[d]])})},support:{prop:c},utils:{extraSafeEntities:[["<",">","'",'"'," "],[32]],encodeEntities:function(b){var c=this,d,e=[];this.extraSafeEntities[1].length===0&&a.each(this.extraSafeEntities[0],function(a,b){c.extraSafeEntities[1].push(b.charCodeAt(0))});d=b.split("");a.each(d,function(b){var f=d[b].charCodeAt(0);a.inArray(f,c.extraSafeEntities[1])&&(f<65||f>127||f>90&&f<97)?e.push("&#"+f+";"):e.push(d[b])});return e.join("")}}};a.wysiwyg.dialog=function(b,c){var d=b&&b.options&&b.options.dialog?b.options.dialog:c.theme?c.theme:"default",e=new a.wysiwyg.dialog.createDialog(d),f=this,g=a(f);this.options={modal:!0,draggable:!0,title:"Title",content:"Content",width:"auto",height:"auto",zIndex:2e3,open:!1,close:!1};this.isOpen=!1;a.extend(this.options,c);this.object=e;this.open=function(){this.isOpen=!0;e.init.apply(f,[]);var a=e.show.apply(f,[]);g.trigger("afterOpen",[a])};this.show=function(){this.isOpen=!0;g.trigger("beforeShow");var a=e.show.apply(f,[]);g.trigger("afterShow")};this.hide=function(){this.isOpen=!1;g.trigger("beforeHide");var a=e.hide.apply(f,[]);g.trigger("afterHide",[a])};this.close=function(){this.isOpen=!1;var a=e.hide.apply(f,[]);g.trigger("beforeClose",[a]);e.destroy.apply(f,[]);g.trigger("afterClose",[a])};this.options.open&&g.bind("afterOpen",this.options.open);this.options.close&&g.bind("afterClose",this.options.close);return this};a.extend(!0,a.wysiwyg.dialog,{_themes:{},_theme:"",register:function(b,c){a.wysiwyg.dialog._themes[b]=c},deregister:function(b){delete a.wysiwyg.dialog._themes[b]},createDialog:function(b){return new a.wysiwyg.dialog._themes[b]},getDimensions:function(){var b=document.body.scrollWidth,c=document.body.scrollHeight;a.browser.opera&&(c=Math.max(a(document).height(),a(window).height(),document.documentElement.clientHeight));return[b,c]}});a(function(){jQuery.ui&&a.wysiwyg.dialog.register("jqueryui",function(){var b=this;this._$dialog=null;this.init=function(){var c=this,d=this.options.content;typeof d=="object"&&(typeof d.html=="function"?d=d.html():typeof d.toString=="function"&&(d=d.toString()));b._$dialog=a("<div></div>").attr("title",this.options.title).html(d);var e=this.options.height=="auto"?300:this.options.height,f=this.options.width=="auto"?450:this.options.width;b._$dialog.dialog({modal:this.options.modal,draggable:this.options.draggable,height:e,width:f});return b._$dialog};this.show=function(){b._$dialog.dialog("open");return b._$dialog};this.hide=function(){b._$dialog.dialog
("close");return b._$dialog};this.destroy=function(){b._$dialog.dialog("destroy");return b._$dialog}});a.wysiwyg.dialog.register("default",function(){var b=this;this._$dialog=null;this.init=function(){var c=this,d=this.options.content;typeof d=="object"&&(typeof d.html=="function"?d=d.html():typeof d.toString=="function"&&(d=d.toString()));b._$dialog=a('<div class="wysiwyg-dialog"></div>').css({"z-index":this.options.zIndex});var e=a('<div class="wysiwyg-dialog-topbar"><div class="wysiwyg-dialog-close-wrapper"></div><div class="wysiwyg-dialog-title">'+this.options.title+"</div></div>"),f=a('<a href="#" class="wysiwyg-dialog-close-button">X</a>');f.click(function(){c.close()});e.find(".wysiwyg-dialog-close-wrapper").prepend(f);var g=a('<div class="wysiwyg-dialog-content">'+d+"</div>");b._$dialog.append(e).append(g);var h=this.options.height=="auto"?300:this.options.height,i=this.options.width=="auto"?450:this.options.width;b._$dialog.hide().css({width:i,height:h,left:(a(window).width()-i)/2,top:(a(window).height()-h)/3});a("body").append(b._$dialog);return b._$dialog};this.show=function(){if(this.options.modal){var c=a.wysiwyg.dialog.getDimensions(),d=a('<div class="wysiwyg-dialog-modal-div"></div>').css({width:c[0],height:c[1]});b._$dialog.wrap(d)}if(this.options.draggable){var e=!1;b._$dialog.find("div.wysiwyg-dialog-topbar").bind("mousedown",function(b){b.preventDefault();a(this).css({cursor:"move"});var c=a(this),d=a(this).parents(".wysiwyg-dialog"),f=b.pageX-parseInt(d.css("left"),10),g=b.pageY-parseInt(d.css("top"),10);e=!0;a(this).css({cursor:"move"});a(document).bind("mousemove",function(a){a.preventDefault();e&&d.css({top:a.pageY-g,left:a.pageX-f})}).bind("mouseup",function(b){b.preventDefault();e=!1;c.css({cursor:"auto"});a(document).unbind("mousemove").unbind("mouseup")})})}b._$dialog.show();return b._$dialog};this.hide=function(){b._$dialog.hide();return b._$dialog};this.destroy=function(){this.options.modal&&b._$dialog.unwrap();this.options.draggable&&b._$dialog.find("div.wysiwyg-dialog-topbar").unbind("mousedown");b._$dialog.remove();return b._$dialog}})});a.fn.wysiwyg=function(c){var d=arguments,e;if("undefined"!=typeof a.wysiwyg[c]){d=Array.prototype.concat.call([d[0]],[this],Array.prototype.slice.call(d,1));return a.wysiwyg[c].apply(a.wysiwyg,Array.prototype.slice.call(d,1))}if("object"==typeof c||!c){Array.prototype.unshift.call(d,this);return a.wysiwyg.init.apply(a.wysiwyg,d)}if(a.wysiwyg.plugin.exists(c)){e=a.wysiwyg.plugin.parseName(c);d=Array.prototype.concat.call([d[0]],[this],Array.prototype.slice.call(d,1));return a.wysiwyg[e.name][e.method].apply(a.wysiwyg[e.name],Array.prototype.slice.call(d,1))}b.error("Method '"+c+"' does not exist on jQuery.wysiwyg.\nTry to include some extra controls or plugins")};a.fn.getWysiwyg=function(){return this.data("wysiwyg")}})(jQuery);(function(a){"use strict";if(undefined===a.wysiwyg)throw"wysiwyg.link.js depends on $.wysiwyg";a.wysiwyg.controls||(a.wysiwyg.controls={});a.wysiwyg.controls.link={init:function(b){var c=this,d,e,f,g,h,i,j,k,l,m,n,o;j={legend:"Insert Link",url:"Link URL",title:"Link Title",target:"Link Target",submit:"Insert Link",reset:"Cancel"};i='<form class="wysiwyg"><fieldset><legend>{legend}</legend><label>{url}: <input type="text" name="linkhref" value=""/></label><label>{title}: <input type="text" name="linktitle" value=""/></label><label>{target}: <input type="text" name="linktarget" value=""/></label><input type="submit" class="button" value="{submit}"/> <input type="reset" value="{reset}"/></fieldset></form>';for(k in j){if(a.wysiwyg.i18n){l=a.wysiwyg.i18n.t(j[k],"dialogs.link");l===j[k]&&(l=a.wysiwyg.i18n.t(j[k],"dialogs"));j[k]=l}m=new RegExp("{"+k+"}","g");i=i.replace(m,j[k])}g={self:b.dom.getElement("a"),href:"http://",title:"",target:""};if(g.self){g.href=g.self.href?g.self.href:g.href;g.title=g.self.title?g.self.title:"";g.target=g.self.target?g.self.target:""}if(a.fn.dialog){d=a(i);d.find("input[name=linkhref]").val(g.href);d.find("input[name=linktitle]").val(g.title);d.find("input[name=linktarget]").val(g.target);if(a.browser.msie)try{e=d.appendTo(b.editorDoc.body)}catch(p){e=d.appendTo("body")}else e=d.appendTo("body");e.dialog({modal:!0,open:function(c,d){a("input:submit",e).click(function(c){c.preventDefault();var d=a('input[name="linkhref"]',e).val(),f=a('input[name="linktitle"]',e).val(),i=a('input[name="linktarget"]',e).val(),j,k;if(b.options.controlLink.forceRelativeUrls){j=window.location.protocol+"//"+window.location.hostname;0===d.indexOf(j)&&(d=d.substr(j.length))}if(g.self)"string"==typeof d&&(d.length>0?a(g.self).attr("href",d).attr("title",f).attr("target",i):a(g.self).replaceWith(g.self.innerHTML));else{a.browser.msie&&b.ui.returnRange();h=b.getRangeText();k=b.dom.getElement("img");if(h&&h.length>0||k){a.browser.msie&&b.ui.focus();"string"==typeof d&&(d.length>0?b.editorDoc.execCommand("createLink",!1,d):b.editorDoc.execCommand("unlink",!1,null));g.self=b.dom.getElement("a");a(g.self).attr("href",d).attr("title",f);a(g.self).attr("target",i)}else b.options.messages.nonSelection&&window.alert(b.options.messages.nonSelection)}b.saveContent();a(e).dialog("close")});a("input:reset",e).click(function(b){b.preventDefault();a(e).dialog("close")})},close:function(a,b){e.dialog("destroy");e.remove()}})}else{if(g.self){f=window.prompt("URL",g.href);if(b.options.controlLink.forceRelativeUrls){n=window.location.protocol+"//"+window.location.hostname;0===f.indexOf(n)&&(f=f.substr(n.length))}"string"==typeof f&&(f.length>0?a(g.self).attr("href",f):a(g.self).replaceWith(g.self.innerHTML))}else{h=b.getRangeText();o=b.dom.getElement("img");if(h&&h.length>0||o)if(a.browser.msie){b.ui.focus();b.editorDoc.execCommand("createLink",!0,null)}else{f=window.prompt(j.url,g.href);if(b.options.controlLink.forceRelativeUrls){n=window.location.protocol+"//"+window.location.hostname;0===f.indexOf(n)&&(f=f.substr(n.length))}"string"==typeof f&&(f.length>0?b.editorDoc.execCommand("createLink",!1,f):b.editorDoc.execCommand("unlink",!1,null))}else b.options.messages.nonSelection&&window.alert(b.options.messages.nonSelection)}b.saveContent()}a(b.editorDoc).trigger("editorRefresh.wysiwyg")}};a.wysiwyg.createLink=function(b,c){return b.each(function(){var b=a(this).data("wysiwyg"),d;if(!b)return this;if(!c||c.length===0)return this;d=b.getRangeText();if(d&&d.length>0){a.browser.msie&&b.ui.focus();b.editorDoc.execCommand("unlink",!1,null);b.editorDoc.execCommand("createLink",!1,c)}else b.options.messages.nonSelection&&window.alert(b.options.messages.nonSelection);return this})}})(jQuery);SustainabilitySummary.prototype={update:function(){this._update()}};$(document).ready(function(){$("#body button, #body input:submit, div.actionButtons button,  div.actionButtons input:submit").button();$("div.userWarning a").click(function(a){a.preventDefault();$("#googleSignInForm").submit()});$("#usermenu button").hover(function(){$(this).addClass("hoverButton")},function(){$(this).removeClass("hoverButton")});$("body span.cancelAction").each(function(){var a=$(this).find("a").html(),b=$(this).find("a").attr("href");$(this).html('<input type="button" value="'+a+'" />');$(this).find("input").button();b!=""&&b!="#"&&$(this).find("input").click(function(a){document.location.href=b})});$("form").each(function(){$(this).validate()});$("#flashMessage p.flashMessageContent").html()!=null&&$.gritter.add({title:$("#flashMessage p.flashMessageTitle").html(),text:$("#flashMessage p.flashMessageContent").html()})});$(document).ready(function(){$("div.newProject button").click(function(){document.location.href=config.projectsNewUrl});$("#btnEditProject").click(function(){document.location.href=config.projectsEditUrl});$("#formCloneProject").dialog({autoOpen:!1,modal:!0,resizable:!1});$("#btnCloneProject").click(function(){$("#formCloneProject").dialog("open")});$("#formCloneProject .cancelAction input").click(function(){$("#formCloneProject").dialog("close")});$("#shareProject").dialog({autoOpen:!1,modal:!0,resizable:!1});$("#formDeleteProject").dialog({autoOpen:!1,modal:!0,resizable:!1});$("#btnShareProject").click(function(){$("#shareProject").dialog("open")});$("#btnDeleteProject").click(function(){$("#formDeleteProject").dialog("open")});$("#formDeleteProject .cancelAction input").click(function(){$("#formDeleteProject").dialog("close")})});$(document).ready(function(){$("#materialsList").dataTable({bProcessing:!0,bJQueryUI:!0,sPaginationType:"full_numbers",bLengthChange:!1,iDisplayLength:50,sAjaxSource:config.materialLibraryUrl+"/list.json",aoColumnDefs:[{sClass:"column-1",aTargets:[0]},{sClass:"column-2",aTargets:[1]},{sClass:"column-3",aTargets:[2]},{sClass:"column-4",aTargets:[3]},{sClass:"column-5",aTargets:[4]},{sClass:"column-6",aTargets:[5]},{sClass:"column-7",aTargets:[6]}]}).makeEditable({sAddURL:config.materialLibraryUrl,sDeleteURL:config.materialLibraryUrl+"/delete",sUpdateURL:config.materialLibraryUrl+"/update",sAddNewRowButtonId:"btnAddMaterial",sAddNewRowFormId:"formAddMaterial",oAddNewRowOkButtonOptions:{label:config.saveText},sDeleteRowButtonId:"btnDeleteMaterial",oDeleteRowButtonOptions:{},aoColumns:[{cssclass:"required"},{cssclass:"required",type:"select",onblur:"submit",loadurl:config.materialLibraryUrl+"/types.json",loadtype:"GET",event:"click"},{cssclass:"required"},{cssclass:"number"},{cssclass:"required number"},{cssclass:"required number"},{cssclass:"number"}]});$("#formBulkAddMaterials").dialog({autoOpen:!1,modal:!0,resizable:!1});$("#btnBulkAddMaterials").removeAttr("disabled").click(function(){$("#formBulkAddMaterials").dialog("open")});$("#formBulkAddMaterials .cancelAction input").click(function(){$("#formBulkAddMaterials").dialog("close")})});$(document).ready(function(){var a=config.projectsUrl+"list.json";config.projectsListAll=="true"&&(a+="?all=true");$("#projectsList").dataTable({bProcessing:!0,bJQueryUI:!0,sPaginationType:"full_numbers",bLengthChange:!1,iDisplayLength:50,sAjaxSource:a,fnDrawCallback:function(){$(".dataTable tbody tr").click(function(){var a=$(this).attr("id");document.location.href=config.projectsUrl+a});$(".dataTable tbody tr").hover(function(){$(this).addClass("row_selected")},function(){$(this).removeClass("row_selected")})},aoColumns:[{bSortable:!0},{bVisible:!1},{bSortable:!0},{iDataSort:4},{bVisible:!1},{bVisible:!1},{bVisible:!1}],aoColumnDefs:[{fnRender:function(a,b){var c="<strong>"+b+"</strong>",d=a.aData[1],e=a.aData[6],f=a.aData[7];if(e||f)c+=" <em>(";e&&(c+="Template");e&&f&&(c+=" &amp; ");f&&(c+="Comparable");if(e||f)c+=")</em>";d!=""&&(c+="<br/>"+d);return c},sClass:"column-1",aTargets:[0]},{sClass:"column-2",aTargets:[2]},{fnRender:function(a,b){var c=b;config.projectsListAll=="true"&&(c+="<br/><em>"+a.aData[5]+"</em>");return c},sClass:"column-3",aTargets:[3]}]});$("#formAddMaterial select").selectmenu({width:"250px"})});$(document).ready(function(){$("div.bomInstructions").accordion({active:2,collapsible:!0,autoHeight:!1});$("#adminTabs").tabs();$("#adminAccordion").accordion({autoHeight:!1});$("#usersList").dataTable({bProcessing:!0,bJQueryUI:!0,sPaginationType:"full_numbers",bLengthChange:!1,iDisplayLength:50,sAjaxSource:config.adminUsersUrl+"/list.json",aoColumnDefs:[{sClass:"column-1",aTargets:[0]},{sClass:"column-2",aTargets:[1]},{sClass:"column-3",aTargets:[2]},{sClass:"column-4",aTargets:[3]},{sClass:"column-5",aTargets:[4]}]}).makeEditable({sDeleteURL:config.adminUsersUrl+"/delete",sUpdateURL:config.adminUsersUrl+"/update",oDeleteRowButtonOptions:{},aoColumns:[{cssclass:"required"},{cssclass:"required"},{cssclass:"required"},{cssclass:"required",type:"select",onblur:"submit",loadurl:config.adminUsersUrl+"/roles.json",loadtype:"GET",event:"click"},{cssclass:"required",type:"select",onblur:"submit",loadurl:config.adminUsersUrl+"/statuses.json",loadtype:"GET",event:"click"}]})});$(document).ready(function(){$("#viewAllProjects").change(function(){alert($(this).val());$("#viewAllProjectsForm").submit()})});$(document).ready(function(){$("textarea.rteditor").wysiwyg({css:config.wysiwygCss,iFrameClass:"wysiwyg-input",controls:{paragraph:{visible:!0,groupIndex:0},h1:{visible:!1},h2:{visible:!0,groupIndex:0},h3:{visible:!0,groupIndex:0},h4:{visible:!0,groupIndex:0},bold:{visible:!0,groupIndex:1},italic:{visible:!0,groupIndex:1},underline:{visible:!1},strikeThrough:{visible:!1},justifyLeft:{visible:!1},justifyRight:{visible:!1},justifyCenter:{visible:!1},justifyFull:{visible:!1},insertImage:{visible:!1},insertTable:{visible:!1},code:{visible:!1},html:{visible:!0}}})});$(document).ready(function(){$("#project select").selectmenu({width:"320px"});$("#preferences select").selectmenu({width:"320px"})});$(document).ready(function(){$("#errorAccordion").accordion({autoHeight:!1})});$(document).ready(function(){$("#formImportBOM").dialog({autoOpen:!1,modal:!0,resizable:!1});$("#bomImportButton").click(function(){$("#formImportBOM").dialog("open")});$("#bomSkipImportButton").click(function(){$(".bomEmpty").removeClass("bomEmpty");$("div.bomImport").remove()})});